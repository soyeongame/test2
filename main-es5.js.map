{"version":3,"sources":["webpack:///src/app/model/sound.ts","webpack:///src/app/components/tile/tile.component.ts","webpack:///src/app/components/tile/tile.component.html","webpack:///src/app/components/image-set-loader/image-set-loader.component.ts","webpack:///src/app/modules/defer-load/defer-load.module.ts","webpack:///src/app/model/consts.ts","webpack:///src/app/components/settings/settings.component.html","webpack:///src/app/components/settings/settings.component.ts","webpack:///src/app/model/import.ts","webpack:///src/app/service/app.service.ts","webpack:///src/app/directives/drop-zone.directive.ts","webpack:///src/app/service/layout.service.ts","webpack:///src/app/modules/defer-load/defer-load.directive.ts","webpack:///src/environments/environment.ts","webpack:///src/app/components/help/help.component.ts","webpack:///src/app/components/help/help.component.html","webpack:///src/app/model/stone.ts","webpack:///src/app/modules/defer-load/rect.ts","webpack:///src/app/modules/defer-load/defer-load.service.ts","webpack:///src/app/model/board.ts","webpack:///src/app/model/tiles.ts","webpack:///src/app/service/svgdef.service.ts","webpack:///src/app/model/types.ts","webpack:///src/app/components/layout-preview/layout-preview.component.ts","webpack:///src/app/components/layout-preview/layout-preview.component.html","webpack:///src/app/modules/defer-load/index.ts","webpack:///src/app/model/i18n.ts","webpack:///src/app/components/game/game-component.component.ts","webpack:///src/app/components/game/game-component.component.html","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/model/clock.ts","webpack:///src/app/pipes/duration.pipe.ts","webpack:///src/app/model/layout-svg.ts","webpack:///src/app/components/tiles-info/tiles-info.component.ts","webpack:///src/app/components/tiles-info/tiles-info.component.html","webpack:///src/app/pipes/prefix.pipe.ts","webpack:///src/app/model/game.ts","webpack:///src/app/model/draw.ts","webpack:///src/environments/version.ts","webpack:///src/app/service/localstorage.service.ts","webpack:///src/app/components/board/board.component.ts","webpack:///src/app/components/board/board.component.html","webpack:///src/app/components/choose-layout/choose-layout.component.ts","webpack:///src/app/components/choose-layout/choose-layout.component.html","webpack:///src/app/model/settings.ts","webpack:///src/app/model/builder.ts","webpack:///src/main.ts","webpack:///src/app/modules/defer-load/defer-load-scroll-host.directive.ts","webpack:///$_lazy_route_resource lazy namespace object"],"names":["SOUNDS","NOPE","SELECT","MATCH","OVER","Sound","enabled","audioplayers","sound","audio","Audio","src","load","play","e","console","error","pause","TileComponent","ImageSetLoaderComponent","elementRef","svgdef","changes","getImageSet","imageSet","get","then","def","s","split","replace","prefix","setTimeout","nativeElement","firstChild","removeChild","innerHTML","doc","DOMParser","parseFromString","node","ownerDocument","importNode","documentElement","appendChild","DeferLoadModule","ngModule","Consts","mY","mX","mZ","tileWidth","tileHeight","STATES","idle","run","freeze","Backgrounds","img","undefined","name","ImageSets","id","type","url","ImageSetDefault","TILES","TILES_INFO","suits","tiles","bonus","honors","SettingsComponent","app","storage","layoutService","translate","sets","backs","layouts","items","layout","clearScore","confirm","instant","clearTimes","clearTimesClick","sortMapping","mapping","sort","a","b","convertMatrix","matrixCount","rowCount","cellCount","board","matrixLength","totalLength","length","Promise","reject","Error","cat","z","matrix","slice","y","row","forEach","cell","x","push","convert3400Matrix","convert2805Matrix","convertKyodai","data","lines","version","includes","nameCat","JSON","stringify","expandMapping","map","result","rows","cells","Array","isArray","count","i","compactMapping","m","Object","keys","entries","entry","start","current","Number","cleanImportLayout","trim","sl","by","toUpperCase","join","minZ","minX","minY","p","Math","min","expandMappingDeprecated","hashString","hash","chr","charCodeAt","mappingToID","toString","AppService","game","settings","setupTranslations","setLang","init","userLang","lang","navigator","language","test","indexOf","use","sounds","save","setTranslation","setDefaultLang","DropZoneDirective","fileDrop","preventBodyDrop","active","event","preventDefault","dataTransfer","files","kind","file","getAsFile","clear","emit","clearData","from","stopPropagation","LayoutService","http","sanitizer","toPromise","o","category","previewSVG","bypassSecurityTrustUrl","readFile","reader","FileReader","resolve","onload","onerror","readAsBinaryString","DeferLoadDirective","deferLoadService","preRender","appDeferLoad","timeoutLoadMS","isBrowser","hasIntersectionObserver","registerIntersectionObserver","addScrollListeners","removeListeners","unobserve","timeoutId","clearTimeout","loadAndUnobserve","cancelDelayLoad","checkIfIntersecting","delayLoad","intersectionObserver","getObserver","observe","onbserveSubscription","observeNotify","subscribe","checkForIntersection","target","manageIntersection","time","isIntersecting","isVisible","scrollSubscription","scrollNotify","checkInView","rect","loadFromScroll","currentViewport","unsubscribe","elemRect","fromElement","intersectsWithY","scrollPosition","getScrollPosition","elementOffset","offsetTop","window","scrollY","pageYOffset","document","clientHeight","body","environment","production","HelpComponent","Stone","v","groupnr","picked","group","hasStone","nodes","top","left","right","bottom","list","stone","safeGetStone","stones","il","Rect","inflateBy","max","empty","element","getBoundingClientRect","_window","innerWidth","innerHeight","DeferLoadService","platformId","scrollSubject","checkIntersectionObserver","observable","asObservable","scrollObservable","pipe","fromWindow","IntersectionObserver","next","threshold","height","userAgent","matches","match","isEdge","isEdgeVersion16OrBetter","parseInt","Board","builder","free","hints","groups","selected","clearSelection","hinted","hintNext","clearHints","collectHints","prefer","canRemove","filter","_stone","isBlocked","state","blocked","removable","undos","build","undo","mode","gn","key","Tiles","tilesMapping","g","tile","SvgdefService","cache","item","request","responseType","res","err","GameStateStore","SettingsStore","LayoutPreviewComponent","updateLayout","currentValue","svg","LANG_EN","RESTART","UNDO","PAUSE","HINT","STONES","FREE","FULLSCREEN","HINT_LONG","UNDO_LONG","RESTART_LONG","PAUSE_LONG","MSG_CONTINUE_PAUSE","MSG_CONTINUE_SAVE","MSG_START","MSG_PLAY_AGAIN","MSG_BEST","MSG_GOOD","MSG_FAIL","STATS_GAMES","STATS_BEST","LICENSE","SHORTCUTS","SETTINGS","STATS","MODE","MODE_SOLVABLE","MODE_LINEAR","MODE_RANDOM","AUDIO","AUDIO_SOUNDS","AUDIO_MUSIC","LANG","LANG_KR","LANG_AUTO","OPEN_SETTINGS","OPEN_HELP","READ_MORE_WIKIPEDIA","READ_MORE_WIKIPEDIA_URL","MODE_SOLVABLE_DESC","MODE_RANDOM_DESC","MODE_LINEAR_DESC","SELECT_BOARD","BOARD_GENERATOR","START_SELECTED","START_RANDOM","TILESET","BACKGROUND","INFO","BEST_TIMES","BEST_TIMES_CLEAR","BEST_TIMES_CLEAR_SURE","BEST_TIME_CLEAR","BEST_TIME_CLEAR_SURE","$event","GameComponent","tilesInfoVisible","helpVisible","settingsVisible","newGameVisible","isIdle","keyCode","toggleHelp","toggleTilesInfo","toggleSettings","which","hint","back","isRunning","isPaused","resume","click","fullScreen","fullscreen","mozFullScreen","webkitIsFullScreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","elem","requestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","reset","enterFullScreen","newGame","stoneClick","AppComponent","meta","loading","updateName","loadLayouts","registerWindowListeners","addEventListener","tag","getTag","content","AppModule","forRoot","Clock","elapsed","lastTime","started","timer","Date","now","step","newtime","pad","num","DurationPipe","value","isNaN","secNum","floor","hours","minutes","seconds","generateStaticLayoutSVG","viewport","draw","pos","btoa","TilesInfoComponent","info","PrefixPipe","Game","clock","layoutID","update","message","msgID","resolveMatchingStone","setStoneSelected","setState","applyMapping","n1","pop","n2","store","getState","storeState","score","getScore","playCount","storeScore","gameOver","playTime","bestTime","sel","gameOverWining","gameOverLoosing","delayedSave","calcDrawPos","sortDrawItems","sortToDraw","ad","bd","getDrawViewPort","width","rotate","bounds","getDrawBounds","mappingToDrawItems","emptySource","visible","source","LocalstorageService","updateData","localStorage","getItem","removeItem","setItem","set","parse","old","BoardComponent","clickEvent","drawStones","resize","index","updateTiles","background","updateBackground","urlPrefix","r","setViewPort","find","backgroundUrl","onResize","onClick","ChooseLayoutComponent","startEvent","buildGroups","selectLastPlayed","storeLastPlayed","getLastPlayed","scrollToItem","random","onStart","importFile","alert","elements","getElementById","scrollIntoView","onDrop","randomGame","Settings","storageProvider","tileset","stats","games","getSettings","storeSettings","array","randomExtract","splice","collectNodes","fillStones","LinearBoardBuilder","remainingTiles","place","RandomBoardBuilder","remainingPlaces","SolvableBoardBuilder","st","pairs","solve","runs","allpairs","tile1","tile2","tile3","tile4","pair","freestones","place1","place2","LoadBoardBuilder","BuilderModes","Builder","modes","buildermode","bootstrapModule","DeferLoadScrollHostDirective","scrollTo","elm","scrollTop","offsetHeight","notifyScroll","webpackEmptyAsyncContext","req","code","module","exports"],"mappings":"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","file":"main-es5.js","sourcesContent":["export const SOUNDS = {\n\tNOPE: 'invalid',\n\tSELECT: 'select',\n\tMATCH: 'match',\n\tOVER: 'over'\n};\n\nexport class Sound {\n\tenabled: boolean = true;\n\tprivate audioplayers: {\n\t\t[index: string]: HTMLAudioElement;\n\t} = {};\n\n\tplay(sound: string): void {\n\t\tif (!this.enabled) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this.audioplayers[sound]) {\n\t\t\tconst audio = new Audio();\n\t\t\taudio.src = `assets/sounds/${sound}.ogg`;\n\t\t\taudio.load();\n\t\t\tthis.audioplayers[sound] = audio;\n\t\t}\n\t\tthis.audioplayers[sound].play()\n\t\t\t.catch(e => {\n\t\t\t\tconsole.error(e);\n\t\t\t});\n\t}\n\n\tpause(sound: string): void {\n\t\tif (this.audioplayers[sound]) {\n\t\t\tthis.audioplayers[sound].pause();\n\t\t}\n\t}\n}\n","import {Component, Input} from '@angular/core';\n\n@Component({\n\tselector: 'app-tile',\n\ttemplateUrl: './tile.component.html',\n\tstyleUrls: ['./tile.component.scss']\n})\nexport class TileComponent {\n\t@Input() imageSet: string;\n\t@Input() tile: string;\n}\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 75 100\" preserveAspectRatio=\"xMidYMid meet\">\n\t<defs app-image-set-loader [imageSet]=\"imageSet\" [prefix]=\"'t_'+imageSet+'_'\"></defs>\n\t<rect class=\"stone\" x=\"0\" y=\"0\" width=\"75\" height=\"100\" rx=\"10\" ry=\"10\"></rect>\n\t<use [attr.xlink:href]=\"'#t_'+imageSet+'_'+tile\" x=\"6\" y=\"6\" width=\"63\" height=\"88\"/>\n</svg>\n","import {Component, ElementRef, Input, OnChanges, SimpleChanges} from '@angular/core';\nimport {SvgdefService} from '../../service/svgdef.service';\n\n@Component({\n\t// eslint-disable-next-line @angular-eslint/component-selector\n\tselector: '[app-image-set-loader]',\n\ttemplate: '<svg:defs></svg:defs>'\n})\nexport class ImageSetLoaderComponent implements OnChanges {\n\t@Input() imageSet: string;\n\t@Input() prefix: string;\n\n\tconstructor(private elementRef: ElementRef, private svgdef: SvgdefService) {\n\t}\n\n\tngOnChanges(changes: SimpleChanges): void {\n\t\tthis.getImageSet();\n\t}\n\n\tprivate getImageSet(): void {\n\t\tif (!this.imageSet) {\n\t\t\treturn;\n\t\t}\n\t\tthis.svgdef.get(this.imageSet)\n\t\t\t.then(def => {\n\t\t\t\tlet s = def.split('<defs>')[1].split('</defs>')[0];\n\t\t\t\ts = s.replace(/xlink:href=\"\\./g, 'xlink:href=\"assets/svg')\n\t\t\t\t\t.replace(/ id=\"t_/g, ` id=\"${this.prefix}t_`);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\twhile (this.elementRef.nativeElement.firstChild) {\n\t\t\t\t\t\tthis.elementRef.nativeElement.removeChild(this.elementRef.nativeElement.firstChild);\n\t\t\t\t\t}\n\t\t\t\t\tthis.elementRef.nativeElement.innerHTML = s;\n\t\t\t\t\tif (!this.elementRef.nativeElement.firstChild) {\n\t\t\t\t\t\tconst doc = new DOMParser().parseFromString(\n\t\t\t\t\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">${s}</svg>`, 'application/xml');\n\t\t\t\t\t\tconst node = this.elementRef.nativeElement.ownerDocument.importNode(doc.documentElement, true);\n\t\t\t\t\t\tthis.elementRef.nativeElement.appendChild(node);\n\t\t\t\t\t}\n\t\t\t\t}, 0);\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.error(e);\n\t\t\t});\n\t}\n}\n","import {CommonModule} from '@angular/common';\nimport {ModuleWithProviders, NgModule} from '@angular/core';\nimport {DeferLoadScrollHostDirective} from './defer-load-scroll-host.directive';\nimport {DeferLoadDirective} from './defer-load.directive';\nimport {DeferLoadService} from './defer-load.service';\n\n@NgModule({\n\timports: [CommonModule],\n\tdeclarations: [DeferLoadDirective, DeferLoadScrollHostDirective],\n\texports: [DeferLoadDirective, DeferLoadScrollHostDirective],\n\tproviders: [DeferLoadService]\n})\nexport class DeferLoadModule {\n\tstatic forRoot(): ModuleWithProviders<DeferLoadModule> {\n\t\treturn {\n\t\t\tngModule: DeferLoadModule\n\t\t};\n\t}\n}\n","export const Consts = {\n\tmY: 18, mX: 38, mZ: 7,\n\ttileWidth: 75,\n\ttileHeight: 100\n};\n\nexport const STATES = {\n\tidle: 0,\n\trun: 1,\n\tpause: 2,\n\tfreeze: 3\n};\n\nexport const Backgrounds: Array<{ img?: string; name: string; small?: boolean }> = [\n\t{img: undefined, name: 'None'},\n\t{img: 'Jelly.jpg', name: 'Jelly'},\n\t{img: 'Idle song.jpg', name: 'Idle song'},\n\t{img: 'LATATA.jpg', name: 'LATATA'},\n\t{img: 'HANN.jpg', name: 'HANN'},\n\t{img: 'Wow Thing.jpg', name: 'Wow Thing'},\n\t{img: 'Senorita.jpg', name: 'Senorita'},\n\t{img: 'Uh-Oh.jpg', name: 'Uh-Oh'},\n\t{img: 'Oh my god.jpg', name: 'Oh my god'},\n\t{img: 'DUMDi DUMDi.jpg', name: 'DUMDi DUMDi'},\n\t{img: 'HWAA.jpg', name: 'HWAA'}\n];\n\nexport const ImageSets = [\n\t{id: 'riichi', type: 'SVG', name: 'Riichi', url: 'https://github.com/FluffyStuff/riichi-mahjong-tiles'},\n\t{id: 'uni', type: 'SVG', name: 'Uni', url: 'https://commons.wikimedia.org/wiki/Category:Unicode_1F000-1F02F_Mahjong_Tiles_(color)'},\n\t{id: 'bzhmaddog', type: 'SVG', name: 'Bzhmaddog', url: 'https://github.com/bzhmaddog/html5-mahjong-solitaire/tree/master/res/skins/default/tiles'},\n\t{id: 'cheshire137', type: 'SVG', name: 'Cheshire', url: 'https://github.com/cheshire137/Mahjong/tree/master/app/assets/images/tiles'},\n\t{id: 'recri2', type: 'SVG', name: 'Recri', url: 'https://github.com/recri/mahjong'},\n\t{id: 'unib', type: 'SVG', name: 'Black', url: 'https://commons.wikimedia.org/wiki/Category:Unicode_1F000-1F02F_Mahjong_Tiles'},\n\t{id: 'gleitz', type: 'PNG', name: 'Gleitz', url: 'https://github.com/gleitz/mahjong/tree/master/public/img/tiles'},\n\t{id: 'recri', type: 'PNG', name: 'Recri', url: 'https://github.com/recri/mahjong'},\n\t{id: 'open-fruits', type: 'PNG', name: 'Fruits', url: 'https://github.com/xunkar/open-mahjong/tree/master/resources/tiles/fruits'},\n\t{id: 'picasso', type: 'PNG', name: 'Picasso', url: 'http://star.physics.yale.edu/~ullrich/software/SolitaireMahjong/'},\n\t{id: 'modern', type: 'PNG', name: 'Modern', url: 'http://star.physics.yale.edu/~ullrich/software/SolitaireMahjong/'},\n\t{id: 'produce101', type: 'PNG', name: 'produce101'}\n];\n\nexport const ImageSetDefault = 'riichi';\n\nexport const TILES = [\n\t['t_do1', 't_do1', 't_do1', 't_do1'],\n\t['t_do2', 't_do2', 't_do2', 't_do2'],\n\t['t_do3', 't_do3', 't_do3', 't_do3'],\n\t['t_do4', 't_do4', 't_do4', 't_do4'],\n\t['t_do5', 't_do5', 't_do5', 't_do5'],\n\t['t_do6', 't_do6', 't_do6', 't_do6'],\n\t['t_do7', 't_do7', 't_do7', 't_do7'],\n\t['t_do8', 't_do8', 't_do8', 't_do8'],\n\t['t_do9', 't_do9', 't_do9', 't_do9'],\n\t['t_ch1', 't_ch1', 't_ch1', 't_ch1'],\n\t['t_ch2', 't_ch2', 't_ch2', 't_ch2'],\n\t['t_ch3', 't_ch3', 't_ch3', 't_ch3'],\n\t['t_ch4', 't_ch4', 't_ch4', 't_ch4'],\n\t['t_ch5', 't_ch5', 't_ch5', 't_ch5'],\n\t['t_ch6', 't_ch6', 't_ch6', 't_ch6'],\n\t['t_ch7', 't_ch7', 't_ch7', 't_ch7'],\n\t['t_ch8', 't_ch8', 't_ch8', 't_ch8'],\n\t['t_ch9', 't_ch9', 't_ch9', 't_ch9'],\n\t['t_ba1', 't_ba1', 't_ba1', 't_ba1'],\n\t['t_ba2', 't_ba2', 't_ba2', 't_ba2'],\n\t['t_ba3', 't_ba3', 't_ba3', 't_ba3'],\n\t['t_ba4', 't_ba4', 't_ba4', 't_ba4'],\n\t['t_ba5', 't_ba5', 't_ba5', 't_ba5'],\n\t['t_ba6', 't_ba6', 't_ba6', 't_ba6'],\n\t['t_ba7', 't_ba7', 't_ba7', 't_ba7'],\n\t['t_ba8', 't_ba8', 't_ba8', 't_ba8'],\n\t['t_ba9', 't_ba9', 't_ba9', 't_ba9'],\n\t['t_se_spring', 't_se_summer', 't_se_fall', 't_se_winter'],\n\t['t_wi_north', 't_wi_north', 't_wi_north', 't_wi_north'],\n\t['t_wi_south', 't_wi_south', 't_wi_south', 't_wi_south'],\n\t['t_wi_east', 't_wi_east', 't_wi_east', 't_wi_east'],\n\t['t_wi_west', 't_wi_west', 't_wi_west', 't_wi_west'],\n\t['t_fl_bamboo', 't_fl_chrysanthemum', 't_fl_orchid', 't_fl_plum'],\n\t['t_dr_green', 't_dr_green', 't_dr_green', 't_dr_green'],\n\t['t_dr_white', 't_dr_white', 't_dr_white', 't_dr_white'],\n\t['t_dr_red', 't_dr_red', 't_dr_red', 't_dr_red']\n];\n\nexport const TILES_INFO = {\n\tsuits: [\n\t\t{\n\t\t\tname: '', tiles: [\n\t\t\t\t{name: '', char: '', img: 't_do1'},\n\t\t\t\t{name: '', char: '', img: 't_do2'},\n\t\t\t\t{name: '', char: '', img: 't_do3'},\n\t\t\t\t{name: '', char: '', img: 't_do4'},\n\t\t\t\t{name: '', char: '', img: 't_do5'},\n\t\t\t\t{name: '', char: '', img: 't_do6'},\n\t\t\t\t{name: '', char: '', img: 't_do7'},\n\t\t\t\t{name: '', char: '', img: 't_do8'},\n\t\t\t\t{name: '', char: '', img: 't_do9'}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tname: '', tiles: [\n\t\t\t\t{name: '', char: '', img: 't_ba1'},\n\t\t\t\t{name: '', char: '', img: 't_ba2'},\n\t\t\t\t{name: '', char: '', img: 't_ba3'},\n\t\t\t\t{name: '', char: '', img: 't_ba4'},\n\t\t\t\t{name: '', char: '', img: 't_ba5'},\n\t\t\t\t{name: '', char: '', img: 't_ba6'},\n\t\t\t\t{name: '', char: '', img: 't_ba7'},\n\t\t\t\t{name: '', char: '', img: 't_ba8'},\n\t\t\t\t{name: '', char: '', img: 't_ba9'}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tname: '', tiles: [\n\t\t\t\t{name: '', char: '', img: 't_ch1'},\n\t\t\t\t{name: '', char: '', img: 't_ch2'},\n\t\t\t\t{name: '', char: '', img: 't_ch3'},\n\t\t\t\t{name: '', char: '', img: 't_ch4'},\n\t\t\t\t{name: '', char: '', img: 't_ch5'},\n\t\t\t\t{name: '', char: '', img: 't_ch6'},\n\t\t\t\t{name: '', char: '', img: 't_ch7'},\n\t\t\t\t{name: '', char: '', img: 't_ch8'},\n\t\t\t\t{name: '', char: '', img: 't_ch9'}\n\t\t\t]\n\t\t}\n\t],\n\n\tbonus: [\n\t\t{\n\t\t\tname: '', tiles: [\n\t\t\t\t{name: '', char: '', img: 't_se_spring'},\n\t\t\t\t{name: '', char: '', img: 't_se_summer'},\n\t\t\t\t{name: '', char: '', img: 't_se_fall'},\n\t\t\t\t{name: '', char: '', img: 't_se_winter'}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tname: '', tiles: [\n\t\t\t\t{name: '', char: '', img: 't_fl_bamboo'},\n\t\t\t\t{name: '', char: '', img: 't_fl_orchid'},\n\t\t\t\t{name: '', char: '', img: 't_fl_plum'},\n\t\t\t\t{name: '', char: '', img: 't_fl_chrysanthemum'}\n\t\t\t]\n\t\t}\n\t],\n\n\thonors: [\n\t\t{\n\t\t\tname: '', tiles: [\n\t\t\t\t{name: '', char: '', img: 't_wi_east'},\n\t\t\t\t{name: '', char: '', img: 't_wi_south'},\n\t\t\t\t{name: '', char: '', img: 't_wi_west'},\n\t\t\t\t{name: '', char: '', img: 't_wi_north'}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tname: '', tiles: [\n\t\t\t\t{name: '', char: '', img: 't_dr_red'},\n\t\t\t\t{name: '', char: '', img: 't_dr_green'},\n\t\t\t\t{name: '', char: '', img: 't_dr_white'}\n\t\t\t]\n\t\t}\n\t]\n};\n","<h1>🦊{{'SETTINGS'|translate}}</h1>\n<div class=\"settings-content\">\n\t<div class=\"settings\">\n\t\t<p>{{'LANG'|translate}}</p>\n\t\t<div class=\"buttons\">\n\t\t\t<form>\n\t\t\t\t<ul class=\"radio\">\n\t\t\t\t\t<li><input type=\"radio\" name=\"lang\" id=\"lang0\" value=\"auto\" [(ngModel)]=\"app.settings.lang\" (ngModelChange)=\"app.setLang()\" /><label for=\"lang0\">{{'LANG_AUTO'|translate}}</label></li>\n\t\t\t\t\t<li><input type=\"radio\" name=\"lang\" id=\"lang1\" value=\"en\" [(ngModel)]=\"app.settings.lang\" (ngModelChange)=\"app.setLang()\" /><label for=\"lang1\">{{'LANG_EN'|translate}}</label></li>\n\t\t\t\t\t<li><input type=\"radio\" name=\"lang\" id=\"lang2\" value=\"kr\" [(ngModel)]=\"app.settings.lang\" (ngModelChange)=\"app.setLang()\" /><label for=\"lang2\">{{'LANG_KR'|translate}}</label></li>\n\t\t\t\t</ul>\n\t\t\t</form>\n\t\t</div>\n\t\t<p>{{'BEST_TIMES'|translate}}</p>\n\t\t<div>\n\t\t\t<button (click)=\"clearTimesClick()\">{{'BEST_TIMES_CLEAR'|translate}}</button>\n\t\t</div>\n\t</div>\n\t<div class=\"settings\">\n\t\t<p>{{'TILESET'|translate}}</p>\n\t\t<div class=\"buttons\">\n\t\t\t<form>\n\t\t\t\t<ul class=\"radio\">\n\t\t\t\t\t<li *ngFor=\"let imageset of sets; let i=index;\"><input type=\"radio\" name=\"imageset\" id=\"imageset{{i}}\" [value]=\"imageset.id\" [(ngModel)]=\"app.settings.tileset\"/><label for=\"imageset{{i}}\">{{imageset.name}}</label></li>\n\t\t\t\t</ul>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n\t<div class=\"settings\">\n\t\t<p>{{'BACKGROUND'|translate}}</p>\n\t\t<div class=\"buttons\">\n\t\t\t<form>\n\t\t\t\t<ul class=\"radio\">\n\t\t\t\t\t<li *ngFor=\"let back of backs; let i=index;\"><input type=\"radio\" name=\"back\" id=\"back{{i}}\" [value]=\"back.img\" [(ngModel)]=\"app.settings.background\"/><label for=\"back{{i}}\">{{back.name}}</label></li>\n\t\t\t\t</ul>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n</div>\n","import {Component} from '@angular/core';\nimport {TranslateService} from '@ngx-translate/core';\nimport {Backgrounds, ImageSets} from '../../model/consts';\nimport {AppService} from '../../service/app.service';\nimport {LayoutService} from '../../service/layout.service';\nimport {LocalstorageService} from '../../service/localstorage.service';\n\n@Component({\n\tselector: 'app-settings',\n\ttemplateUrl: './settings.component.html',\n\tstyleUrls: ['./settings.component.scss']\n})\nexport class SettingsComponent {\n\tsets = ImageSets;\n\tbacks = Backgrounds;\n\n\tconstructor(\n\t\tpublic app: AppService,\n\t\tprivate storage: LocalstorageService,\n\t\tprivate layoutService: LayoutService,\n\t\tprivate translate: TranslateService\n\t) {\n\t}\n\n\tasync clearTimes(): Promise<void> {\n\t\tconst layouts = await this.layoutService.get();\n\t\tfor (const layout of layouts.items) {\n\t\t\tthis.storage.clearScore(layout.id);\n\t\t}\n\t}\n\n\tclearTimesClick(): void {\n\t\tif (confirm(this.translate.instant('BEST_TIMES_CLEAR_SURE'))) {\n\t\t\tthis.clearTimes().catch(e => {\n\t\t\t\tconsole.error(e);\n\t\t\t});\n\t\t}\n\t}\n\n}\n","import {CompactMapping, CompactMappingX, CompactMappingY, ImportLayout, Mapping, Place} from './types';\n\nexport function sortMapping(mapping: Mapping): Mapping {\n\treturn mapping.sort((a: Place, b: Place): number => {\n\t\tif (a[0] < b[0]) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (a[0] > b[0]) {\n\t\t\treturn 1;\n\t\t}\n\t\tif (a[1] < b[1]) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (a[1] > b[1]) {\n\t\t\treturn 1;\n\t\t}\n\t\tif (a[2] < b[2]) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (a[2] > b[2]) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t});\n}\n\nasync function convertMatrix(\n\tmatrixCount: number, rowCount: number, cellCount: number,\n\tname: string, board: string): Promise<ImportLayout> {\n\tconst matrixLength: number = rowCount * cellCount;\n\tconst totalLength: number = matrixLength * matrixCount;\n\tif (board.length !== totalLength) {\n\t\treturn Promise.reject(Error('Invalid Matrix Pattern length'));\n\t}\n\tconst layout: ImportLayout = {name, cat: 'Import', mapping: []};\n\tfor (let z = 0; z < matrixCount; z++) {\n\t\tconst matrix = board.slice(z * matrixLength, (z + 1) * matrixLength);\n\t\tfor (let y = 0; y < rowCount; y++) {\n\t\t\tconst row = matrix.slice(y * cellCount, (y + 1) * cellCount);\n\t\t\trow.split('').forEach((cell, x) => {\n\t\t\t\tif (cell === '1') {\n\t\t\t\t\tlayout.mapping.push([z, x, y]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\treturn layout;\n}\n\nexport async function convert3400Matrix(name: string, board: string): Promise<ImportLayout> {\n\treturn convertMatrix(5, 20, 34, name, board);\n}\n\nexport async function convert2805Matrix(name: string, board: string): Promise<ImportLayout> {\n\treturn convertMatrix(5, 17, 33, name, board);\n}\n\nexport async function convertKyodai(data: string): Promise<ImportLayout> {\n\t// unify line endings\n\tconst lines = data.replace(/\\r\\n/g, '\\n').split('\\n');\n\tconst version = lines[0] || '';\n\tif (['Kyodai 3.0', 'Kyodai 6.0'].includes(version)) {\n\t\tconst nameCat = (lines[1] || '').split('::');\n\t\tconst name = nameCat[0] || '';\n\t\tconst cat = nameCat[1];\n\t\tconst board = lines[2] || '';\n\t\tconst layout = await convert3400Matrix(name, board);\n\t\tlayout.cat = cat || layout.cat;\n\t\treturn layout;\n\t}\n\treturn Promise.reject(Error(`Unknown .lay format ${  JSON.stringify((version || '').slice(0, 50))}`));\n}\n\n/*\nexport function compactMappingDeprecated(mapping: Mapping): Mapping {\n\tlet maplist: Mapping = [];\n\tmapping.forEach(o => {\n\t\tconst place: Array<number> = [];\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tplace.push(o[i]);\n\t\t}\n\t\tmaplist.push(place);\n\t});\n\tmaplist = sortMapping(maplist);\n\tconst result: Mapping = [];\n\tfor (let i = maplist.length - 1; i >= 1; i--) {\n\t\tconst item = maplist[i];\n\t\tconst before = maplist[i - 1];\n\t\tif (before && (item[0] === before[0]) && (item[2] === before[2]) && (item[1] - 2 === before[1])) {\n\t\t\tbefore[3] = (before[3] || 1) + (item[3] || 1);\n\t\t} else if ((item[3] || 1) === 1) {\n\t\t\tresult.unshift([item[0], item[1], item[2]]);\n\t\t} else {\n\t\t\tresult.unshift(item);\n\t\t}\n\t}\n\tconst first = maplist[0];\n\tresult.unshift([first[0], first[1], first[2]]);\n\treturn result;\n}\n*/\n\nexport function expandMapping(map: CompactMapping): Mapping {\n\tconst result: Mapping = [];\n\tmap.forEach(matrix => {\n\t\tconst z = matrix[0] as number;\n\t\tconst rows = matrix[1] as Array<CompactMappingY>;\n\t\trows.forEach(row => {\n\t\t\tconst y = row[0] as number;\n\t\t\tconst cells = row[1] as CompactMappingX;\n\t\t\tif (!Array.isArray(cells)) {\n\t\t\t\tresult.push([z, cells, y]);\n\t\t\t} else {\n\t\t\t\tcells.forEach(cell => {\n\t\t\t\t\tif (Array.isArray(cell)) {\n\t\t\t\t\t\tlet x = cell[0];\n\t\t\t\t\t\tconst count = cell[1];\n\t\t\t\t\t\tfor (let i = 0; i < count; i++) {\n\t\t\t\t\t\t\tresult.push([z, x, y]);\n\t\t\t\t\t\t\tx += 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.push([z, cell, y]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\treturn result;\n}\n\nexport function compactMapping(mapping: Mapping): CompactMapping {\n\tconst board: any = {};\n\tsortMapping(mapping).forEach(m => {\n\t\tboard[m[0]] = board[m[0]] || {};\n\t\tboard[m[0]][m[2]] = board[m[0]][m[2]] || [];\n\t\tboard[m[0]][m[2]].push(m[1]);\n\t});\n\tconst result: CompactMapping = [];\n\tfor (const z of Object.keys(board)) {\n\t\tconst rows: Array<CompactMappingY> = [];\n\t\tfor (const y of Object.keys(board[z])) {\n\t\t\tconst a: Array<number> = board[z][y];\n\t\t\tconst entries: Array<{ start: number; current: number; count: number }> = [];\n\t\t\tlet entry = {start: -1, current: -1, count: 0};\n\t\t\ta.forEach(x => {\n\t\t\t\tif (x !== entry.current) {\n\t\t\t\t\tentry = {start: x, current: x + 2, count: 1};\n\t\t\t\t\tentries.push(entry);\n\t\t\t\t} else {\n\t\t\t\t\tentry.current += 2;\n\t\t\t\t\tentry.count++;\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst cells: CompactMappingX = entries.map(e => {\n\t\t\t\tif (e.count === 1) {\n\t\t\t\t\treturn e.start;\n\t\t\t\t}\n\t\t\t\treturn [e.start, e.count];\n\t\t\t});\n\t\t\tif (cells.length === 1 && !Array.isArray(cells[0])) {\n\t\t\t\trows.push([Number(y), cells[0]]);\n\t\t\t} else {\n\t\t\t\trows.push([Number(y), cells]);\n\t\t\t}\n\t\t}\n\t\tresult.push([Number(z), rows]);\n\t}\n\treturn result;\n}\n\nexport function cleanImportLayout(layout: ImportLayout): ImportLayout {\n\tlayout.name = layout.name.trim();\n\n\t// split author\n\tconst sl = layout.name.split(' by ');\n\tif (sl.length > 1) {\n\t\tlayout.name = sl[0].trim();\n\t\tlayout.by = sl[1].trim();\n\t}\n\n\t// Capitalize\n\tlayout.name = layout.name.split(' ').map(s => s[0].toUpperCase() + s.slice(1)).join(' ');\n\n\t// move board to left/top/min z-index\n\tlet minZ: number = layout.mapping[0][0];\n\tlet minX: number = layout.mapping[0][1];\n\tlet minY: number = layout.mapping[0][2];\n\tlayout.mapping.forEach(p => {\n\t\tminZ = Math.min(p[0], minZ);\n\t\tminX = Math.min(p[1], minX);\n\t\tminY = Math.min(p[2], minY);\n\t});\n\tlayout.mapping.forEach(p => {\n\t\tp[0] = p[0] - (minZ || 0);\n\t\tp[1] = p[1] - (minX || 0);\n\t\tp[2] = p[2] - (minY || 0);\n\t});\n\treturn layout;\n}\n\nexport function expandMappingDeprecated(mapping: Mapping): Mapping {\n\tconst result: Mapping = [];\n\tif (mapping) {\n\t\tmapping.forEach(m => {\n\t\t\tfor (let i = 0; i < (m[3] || 1); i++) {\n\t\t\t\tresult.push([m[0], m[1] + (i * 2), m[2]]);\n\t\t\t}\n\t\t});\n\t}\n\treturn result;\n}\n\nfunction hashString(s: string): number {\n\tlet hash = 0;\n\tlet i: number;\n\tlet chr: number;\n\tif (s.length === 0) {\n\t\treturn hash;\n\t}\n\tfor (i = 0; i < s.length; i++) {\n\t\tchr = s.charCodeAt(i);\n\t\t// eslint-disable-next-line no-bitwise\n\t\thash = ((hash << 5) - hash) + chr;\n\t\t// eslint-disable-next-line no-bitwise\n\t\thash |= 0; // Convert to 32bit integer\n\t}\n\treturn hash + 2147483647;\n}\n\nexport function mappingToID(mapping: Mapping): string {\n\treturn hashString(JSON.stringify(mapping)).toString();\n}\n","import {Injectable} from '@angular/core';\nimport {TranslateService} from '@ngx-translate/core';\nimport {Game} from '../model/game';\nimport {LANG_KR, LANG_EN} from '../model/i18n';\nimport {Settings} from '../model/settings';\nimport {LocalstorageService} from './localstorage.service';\n\n@Injectable()\nexport class AppService {\n\tname: string = 'Mah Jong';\n\tgame: Game;\n\tsettings: Settings;\n\n\tconstructor(private storage: LocalstorageService, private translate: TranslateService) {\n\t\tthis.game = new Game(storage);\n\t\tthis.settings = new Settings(storage);\n\t\tthis.settings.load();\n\t\tthis.setupTranslations();\n\t\tthis.setLang();\n\t\tthis.game.init();\n\t}\n\n\tsetLang(): void {\n\t\tlet userLang: string;\n\t\tif (!this.settings.lang || this.settings.lang === 'auto') {\n\t\t\tuserLang = navigator.language.split('-')[0]; // use navigator lang if available\n\t\t\tuserLang = /(kr|en)/gi.test(userLang) ? userLang : 'en';\n\t\t} else {\n\t\t\tuserLang = this.settings.lang;\n\t\t}\n\t\tif (['kr', 'en'].indexOf(userLang) >= 0) {\n\t\t\tthis.translate.use(userLang);\n\t\t}\n\t}\n\n\ttoggleSound(): void {\n\t\tthis.settings.sounds = !this.settings.sounds;\n\t\tthis.game.sound.enabled = this.settings.sounds;\n\t\tthis.settings.save();\n\t}\n\n\tprivate setupTranslations(): void {\n\t\tthis.translate.setTranslation('en', LANG_EN);\n\t\tthis.translate.setTranslation('kr', LANG_KR);\n\t\tthis.translate.setDefaultLang('en');\n\t}\n\n}\n","import {Directive, EventEmitter, HostBinding, HostListener, Input, Output} from '@angular/core';\n\n// Angular Drag and Drop File\n//\n// Add this directive to an element to turn it into a dropzone\n// for drag and drop of files.\n// Example:\n//\n// <div (appDropZone)=\"onDrop($event)\"></div>\n//\n// Any files dropped onto the region are then\n// returned as a Javascript array of file objects.\n// Which in TypeScript is `Array<File>`\n//\n// https://gist.github.com/darrenmothersele/7afda13d858a156ce571510dd78b7624\n\n@Directive({selector: '[appDropZone]'})\nexport class DropZoneDirective {\n\n\t// The directive emits a `fileDrop` event\n\t// with the list of files dropped on the element\n\t// as an JS array of `File` objects.\n\t@Output('appDropZone') readonly fileDrop = new EventEmitter<Array<File>>();\n\n\t// Disable dropping on the body of the document.\n\t// This prevents the browser from loading the dropped files\n\t// using it's default behaviour if the user misses the drop zone.\n\t// Set this input to false if you want the browser default behaviour.\n\t@Input() preventBodyDrop = true;\n\n\t// The `drop-zone-active` class is applied to the host\n\t// element when a drag is currently over the target.\n\t@HostBinding('class.drop-zone-active') active = false;\n\n\t@HostListener('drop', ['$event'])\n\tonDrop(event: DragEvent): void {\n\t\tevent.preventDefault();\n\t\tthis.active = false;\n\n\t\tconst {dataTransfer} = event;\n\n\t\tif (dataTransfer?.items) {\n\t\t\tconst files: Array<File> = [];\n\t\t\t// eslint-disable-next-line @typescript-eslint/prefer-for-of\n\t\t\tfor (let i = 0; i < dataTransfer.items.length; i++) {\n\t\t\t\t// If dropped items aren't files, reject them\n\t\t\t\tif (dataTransfer.items[i] && dataTransfer.items[i].kind === 'file') {\n\t\t\t\t\tconst file = dataTransfer.items[i].getAsFile();\n\t\t\t\t\t// eslint-disable-next-line no-null/no-null\n\t\t\t\t\tif (file !== undefined && file !== null) {\n\t\t\t\t\t\tfiles.push(file);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tdataTransfer.items.clear();\n\t\t\tthis.fileDrop.emit(files);\n\t\t} else if (dataTransfer) {\n\t\t\tconst files = dataTransfer?.files;\n\t\t\tdataTransfer.clearData();\n\t\t\tif (files) {\n\t\t\t\tthis.fileDrop.emit(Array.from(files));\n\t\t\t}\n\t\t}\n\t}\n\n\t@HostListener('dragover', ['$event'])\n\tonDragOver(event: DragEvent): void {\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t\tthis.active = true;\n\t}\n\n\t@HostListener('dragleave', ['$event'])\n\tonDragLeave(event: DragEvent): void {\n\t\tthis.active = false;\n\t}\n\n\t@HostListener('body:dragover', ['$event'])\n\tonBodyDragOver(event: DragEvent): void {\n\t\tif (this.preventBodyDrop) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t}\n\t}\n\n\t@HostListener('body:drop', ['$event'])\n\tonBodyDrop(event: DragEvent): void {\n\t\tif (this.preventBodyDrop) {\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n}\n","import {HttpClient} from '@angular/common/http';\nimport {Injectable} from '@angular/core';\nimport {DomSanitizer} from '@angular/platform-browser';\nimport {cleanImportLayout, convertKyodai, expandMapping, expandMappingDeprecated, mappingToID} from '../model/import';\nimport {generateStaticLayoutSVG} from '../model/layout-svg';\nimport {Layout, Layouts, LoadLayout, Mapping} from '../model/types';\n\n@Injectable()\nexport class LayoutService {\n\tlayouts: Layouts;\n\n\tconstructor(private http: HttpClient, private sanitizer: DomSanitizer) {\n\t}\n\n\tasync get(): Promise<Layouts> {\n\t\tif (this.layouts) {\n\t\t\treturn this.layouts;\n\t\t}\n\t\tconst result: Array<LoadLayout> = await this.http.get<Array<LoadLayout>>('assets/data/boards.json').toPromise();\n\n\t\tconst items: Array<Layout> = [];\n\t\tfor (const o of result) {\n\t\t\tconst name = o.name;\n\t\t\tconst category = o.cat || 'Classic';\n\t\t\tlet mapping: Mapping = [];\n\t\t\tif (o.map) {\n\t\t\t\tmapping = expandMapping(o.map);\n\t\t\t}\n\t\t\tif (o.mapping) {\n\t\t\t\tmapping = expandMappingDeprecated(o.mapping);\n\t\t\t}\n\t\t\tif (mapping.length > 0) {\n\t\t\t\tconst layout = {id: o.id ? o.id : mappingToID(mapping), name, category, mapping, previewSVG: this.sanitizer.bypassSecurityTrustUrl(generateStaticLayoutSVG(mapping))};\n\t\t\t\titems.push(layout);\n\t\t\t}\n\t\t}\n\t\tthis.layouts = {items};\n\t\treturn this.layouts;\n\t}\n\n\tasync importFile(file: File): Promise<Layout> {\n\t\tconst s = await LayoutService.readFile(file);\n\t\tlet layout = await convertKyodai(s);\n\t\tlayout = cleanImportLayout(layout);\n\t\tconst previewSVG = this.sanitizer.bypassSecurityTrustUrl(generateStaticLayoutSVG(layout.mapping));\n\t\treturn {id: mappingToID(layout.mapping), name: layout.name, mapping: layout.mapping, category: layout.cat || 'Import', previewSVG};\n\t}\n\n\tprivate static async readFile(file: File): Promise<string> {\n\t\tconst reader = new FileReader();\n\t\treturn new Promise<string>((resolve, reject) => {\n\t\t\treader.onload = () => {\n\t\t\t\tresolve(reader.result as string);\n\t\t\t};\n\t\t\treader.onerror = () => {\n\t\t\t\treject(Error(`Reading File failed: ${reader.error}`));\n\t\t\t};\n\t\t\treader.readAsBinaryString(file);\n\t\t});\n\t}\n\n}\n","import {AfterViewInit, Directive, ElementRef, EventEmitter, Input, OnDestroy, Output} from '@angular/core';\nimport {Subscription} from 'rxjs';\nimport {DeferLoadService, ScrollNotifyEvent} from './defer-load.service';\nimport {Rect} from './rect';\n\n@Directive({\n\tselector: '[appDeferLoad]'\n})\nexport class DeferLoadDirective implements AfterViewInit, OnDestroy {\n\n\t@Input() preRender: boolean = false;\n\t@Output() readonly appDeferLoad: EventEmitter<any> = new EventEmitter();\n\n\tprivate intersectionObserver?: IntersectionObserver;\n\tprivate scrollSubscription?: Subscription;\n\tprivate onbserveSubscription?: Subscription;\n\tprivate timeoutId?: number;\n\tprivate timeoutLoadMS: number = 20;\n\n\tconstructor(private elementRef: ElementRef, private deferLoadService: DeferLoadService) {\n\t}\n\n\tngAfterViewInit(): void {\n\t\tif (this.deferLoadService.isBrowser) {\n\t\t\tif (this.deferLoadService.hasIntersectionObserver) {\n\t\t\t\tthis.registerIntersectionObserver();\n\t\t\t} else {\n\t\t\t\tthis.addScrollListeners();\n\t\t\t}\n\t\t} else if (this.preRender) {\n\t\t\tthis.load();\n\t\t}\n\t}\n\n\tngOnDestroy(): void {\n\t\tthis.removeListeners();\n\t}\n\n\tprivate static getScrollPosition(): number {\n\t\t// Getting screen size and scroll position for IE\n\t\treturn (window.scrollY || window.pageYOffset)\n\t\t\t+ (document.documentElement.clientHeight || document.body.clientHeight);\n\t}\n\n\tprivate loadAndUnobserve(): void {\n\t\tthis.load();\n\t\tthis.unobserve();\n\t\tthis.removeListeners();\n\t}\n\n\tprivate cancelDelayLoad(): void {\n\t\tif (!this.timeoutId) {\n\t\t\treturn; // do nothing if timeout doesn't exist\n\t\t}\n\t\tclearTimeout(this.timeoutId);\n\t\tthis.timeoutId = undefined;\n\t}\n\n\tprivate delayLoad(): void {\n\t\tif (this.timeoutId) {\n\t\t\treturn; // timeout was already set, do nothing\n\t\t}\n\t\tthis.timeoutId = setTimeout(() => {\n\t\t\tthis.loadAndUnobserve();\n\t\t\tthis.cancelDelayLoad();\n\t\t}, this.timeoutLoadMS) as any;\n\t}\n\n\tprivate manageIntersection(entry: IntersectionObserverEntry): void {\n\t\tif (this.checkIfIntersecting(entry)) {\n\t\t\tthis.delayLoad();\n\t\t} else {\n\t\t\tthis.cancelDelayLoad();\n\t\t}\n\t}\n\n\tprivate registerIntersectionObserver(): void {\n\t\tif (!!this.intersectionObserver) {\n\t\t\treturn;\n\t\t}\n\t\tthis.intersectionObserver = this.deferLoadService.getObserver();\n\t\tif (this.intersectionObserver && this.elementRef.nativeElement) {\n\t\t\tthis.intersectionObserver.observe(this.elementRef.nativeElement as Element);\n\t\t\tthis.onbserveSubscription = this.deferLoadService.observeNotify\n\t\t\t\t.subscribe((entries: Array<IntersectionObserverEntry>) => {\n\t\t\t\t\tthis.checkForIntersection(entries);\n\t\t\t\t});\n\t\t}\n\t}\n\n\tprivate checkForIntersection(entries: Array<IntersectionObserverEntry>) {\n\t\tentries.forEach((entry: IntersectionObserverEntry) => {\n\t\t\tif (entry.target === this.elementRef.nativeElement) {\n\t\t\t\tthis.manageIntersection(entry);\n\t\t\t}\n\t\t});\n\t};\n\n\tprivate checkIfIntersecting(entry: IntersectionObserverEntry): boolean {\n\t\t// For Samsung native browser, IO has been partially implemented where by the\n\t\t// callback fires, but entry object is empty. We will check manually.\n\t\tif (entry && entry.time) {\n\t\t\treturn entry.isIntersecting;\n\t\t}\n\t\treturn this.isVisible();\n\t}\n\n\tprivate load(): void {\n\t\tthis.removeListeners();\n\t\tthis.appDeferLoad.emit();\n\t}\n\n\tprivate loadFromScroll(): void {\n\t\tsetTimeout(() => {\n\t\t\tthis.load();\n\t\t});\n\t}\n\n\tprivate addScrollListeners(): void {\n\t\tthis.scrollSubscription = this.deferLoadService.scrollNotify\n\t\t\t.subscribe((event: ScrollNotifyEvent) => {\n\t\t\t\tif (this.checkInView(event.rect)) {\n\t\t\t\t\tthis.loadFromScroll();\n\t\t\t\t}\n\t\t\t});\n\t\tsetTimeout(() => {\n\t\t\tif (this.checkInView(this.deferLoadService.currentViewport)) {\n\t\t\t\tthis.loadFromScroll();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate unobserve(): void {\n\t\tif (this.intersectionObserver && this.elementRef.nativeElement) {\n\t\t\tthis.intersectionObserver.unobserve(this.elementRef.nativeElement as Element);\n\t\t\tthis.intersectionObserver = undefined;\n\t\t}\n\t}\n\n\tprivate removeListeners(): void {\n\t\tif (this.scrollSubscription) {\n\t\t\tthis.scrollSubscription.unsubscribe();\n\t\t\tthis.scrollSubscription = undefined;\n\t\t}\n\t\tthis.unobserve();\n\t\tif (this.onbserveSubscription) {\n\t\t\tthis.onbserveSubscription.unsubscribe();\n\t\t\tthis.onbserveSubscription = undefined;\n\t\t}\n\t}\n\n\tprivate checkInView(rect: Rect): boolean {\n\t\tconst elemRect = Rect.fromElement(this.elementRef.nativeElement);\n\t\treturn elemRect.intersectsWithY(rect);\n\t}\n\n\tprivate isVisible(): boolean {\n\t\tconst scrollPosition = DeferLoadDirective.getScrollPosition();\n\t\tconst elementOffset = this.elementRef.nativeElement.offsetTop;\n\t\treturn elementOffset <= scrollPosition;\n\t}\n}\n","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\nimport {version} from './version';\n\nexport const environment = {\n\tproduction: false,\n\tversion\n};\n","import {Component} from '@angular/core';\nimport {environment} from '../../../environments/environment';\nimport {AppService} from '../../service/app.service';\n\n@Component({\n\tselector: 'app-help',\n\ttemplateUrl: './help.component.html',\n\tstyleUrls: ['./help.component.scss']\n})\nexport class HelpComponent {\n\tversion = environment.version;\n\n\tconstructor(public app: AppService) {\n\t}\n}\n","<h1>🦊{{app.name}} Solitaire v{{version}}</h1>\n<div class=\"help-content\">\n\t<div class=\"license\">\n\t\t<p>{{'LICENSE'|translate}}</p>\n\t\t<div class=\"license-list\">\n\t\t\t<div><div class=\"name\">Game</div><div class=\"info\"><a rel=\"noopener\" target=\"_blank\" href=\"https://github.com/ffalt/mah/blob/main/README.md\">MIT</a></div></div>\n\t\t\t<div><div class=\"name\">Sounds</div><div class=\"info\"><a rel=\"noopener\" href=\"https://github.com/ffalt/mah/blob/main/src/assets/sounds/README.md\">CC0/CC-BY3.0</a></div></div>\n\t\t\t<div><div class=\"name\">Fonts</div><div class=\"info\"><a rel=\"noopener\" target=\"_blank\" href=\"https://github.com/ffalt/mah/blob/main/src/fonts/README.md\">SIL</a></div></div>\n\t\t</div>\n\t</div>\n\t<div class=\"keyboard\">\n\t\t<p>{{'SHORTCUTS'|translate}}</p>\n\t\t<div class=\"keyboard-list\">\n\t\t\t<div><div class=\"name\"><span class=\"key\">T</span></div><div class=\"info\"><span>{{'HINT'|translate}}</span><span class=\"func\">{{'HINT_LONG'|translate}}</span></div></div>\n\t\t\t<div><div class=\"name\"><span class=\"key\">U</span></div><div class=\"info\"><span>{{'UNDO'|translate}}</span><span class=\"func\">{{'UNDO_LONG'|translate}}</span></div></div>\n\t\t\t<div><div class=\"name\"><span class=\"key\">N</span></div><div class=\"info\"><span>{{'RESTART'|translate}}</span><span class=\"func\">{{'RESTART_LONG'|translate}}</span></div></div>\n\t\t\t<div><div class=\"name\"><span class=\"key\">P</span></div><div class=\"info\"><span>{{'PAUSE'|translate}}</span><span class=\"func\">{{'PAUSE_LONG'|translate}}</span></div></div>\n\t\t\t<div><div class=\"name\"><span class=\"key\">I</span></div><div class=\"info\"><span>{{'INFO'|translate}}</span><span class=\"func\">{{'TILES_INFO'|translate}}</span></div></div>\n\t\t</div>\n\t</div>\n</div>\n","export class Stone {\n\tx: number;\n\ty: number;\n\tz: number;\n\tv: number;\n\thinted: boolean;\n\tselected: boolean;\n\tgroupnr: number;\n\tpicked: boolean = false;\n\tstate: {\n\t\tblocked: boolean;\n\t\tremovable: boolean;\n\t};\n\tgroup: Array<Stone> = [];\n\timg: {\n\t\tid?: string;\n\t};\n\tnodes: {\n\t\ttop: Array<Stone>;\n\t\tleft: Array<Stone>;\n\t\tright: Array<Stone>;\n\t\tbottom: Array<Stone>;\n\t};\n\n\tconstructor(z: number, x: number, y: number, v: number, groupnr: number) {\n\t\tthis.z = z;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.v = v;\n\t\tthis.groupnr = groupnr;\n\t}\n\n\tisBlocked(): boolean {\n\t\treturn Stone.hasStone(this.nodes.top) || (Stone.hasStone(this.nodes.left) && Stone.hasStone(this.nodes.right));\n\t}\n\n\tisLoose(): boolean {\n\t\treturn !Stone.hasStone(this.nodes.left) && !Stone.hasStone(this.nodes.right) && !Stone.hasStone(this.nodes.bottom);\n\t}\n\n\tprivate static hasStone(list: Array<Stone>): boolean {\n\t\tfor (const stone of list) {\n\t\t\tif (!stone.picked) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n\nexport const safeGetStone = (stones: Array<Stone>, z: number, x: number, y: number): Stone | undefined => {\n\tfor (let i = 0, il = stones.length; i < il; i++) {\n\t\tif (stones[i].z === z && stones[i].x === x && stones[i].y === y) {\n\t\t\treturn stones[i];\n\t\t}\n\t}\n\treturn;\n};\n","/***\n https://github.com/tjoskar/ng-lazyload-image/blob/master/src/rect.ts\n\n The MIT License (MIT)\n\n Copyright (c) 2016 Oskar Karlsson\n\n Permission is hereby granted, free of charge, to any person obtaining a copy\n of this software and associated documentation files (the \"Software\"), to deal\n in the Software without restriction, including without limitation the rights\n to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the Software is\n furnished to do so, subject to the following conditions:\n\n The above copyright notice and this permission notice shall be included in all\n copies or substantial portions of the Software.\n\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n SOFTWARE.\n */\n\nexport class Rect {\n\tstatic empty: Rect = new Rect(0, 0, 0, 0);\n\tleft: number;\n\ttop: number;\n\tright: number;\n\tbottom: number;\n\n\tconstructor(left: number, top: number, right: number, bottom: number) {\n\t\tthis.left = left;\n\t\tthis.top = top;\n\t\tthis.right = right;\n\t\tthis.bottom = bottom;\n\t}\n\n\tstatic fromElement(element: HTMLElement): Rect {\n\t\tconst {left, top, right, bottom} = element.getBoundingClientRect();\n\t\treturn new Rect(left, top, right, bottom);\n\t}\n\n\tstatic fromWindow(_window: Window): Rect {\n\t\treturn new Rect(0, 0, _window.innerWidth, _window.innerHeight);\n\t}\n\n\tinflate(inflateBy: number): void {\n\t\tthis.left -= inflateBy;\n\t\tthis.top -= inflateBy;\n\t\tthis.right += inflateBy;\n\t\tthis.bottom += inflateBy;\n\t}\n\n\tintersectsWith(rect: Rect): boolean {\n\t\treturn (rect.left < this.right) &&\n\t\t\t(this.left < rect.right) &&\n\t\t\t(rect.top < this.bottom) &&\n\t\t\t(this.top < rect.bottom);\n\t}\n\n\tintersectsWithY(rect: Rect): boolean {\n\t\treturn (rect.top < this.bottom) &&\n\t\t\t(this.top < rect.bottom);\n\t}\n\n\tgetIntersectionWith(rect: Rect): Rect {\n\t\tconst left = Math.max(this.left, rect.left);\n\t\tconst top = Math.max(this.top, rect.top);\n\t\tconst right = Math.min(this.right, rect.right);\n\t\tconst bottom = Math.min(this.bottom, rect.bottom);\n\n\t\tif (right >= left && bottom >= top) {\n\t\t\treturn new Rect(left, top, right, bottom);\n\t\t}\n\t\treturn Rect.empty;\n\t}\n\n}\n","import {isPlatformBrowser} from '@angular/common';\nimport {EventEmitter, Inject, Injectable, PLATFORM_ID} from '@angular/core';\nimport {merge, Observable, Subject} from 'rxjs';\nimport {debounceTime, throttleTime} from 'rxjs/operators';\nimport {Rect} from './rect';\n\nexport interface ScrollEvent {\n\tname: string;\n\telement?: any;\n}\n\nexport interface ScrollNotifyEvent {\n\trect: Rect;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class DeferLoadService {\n\tscrollNotify = new EventEmitter<ScrollNotifyEvent>();\n\tobserveNotify = new EventEmitter<Array<IntersectionObserverEntry>>();\n\tcurrentViewport: Rect = new Rect(0, 0, 0, 0);\n\treadonly isBrowser: boolean;\n\treadonly hasIntersectionObserver: boolean;\n\tprivate scrollSubject = new Subject<ScrollNotifyEvent>();\n\tprivate scrollObservable: Observable<ScrollNotifyEvent>;\n\tprivate intersectionObserver?: IntersectionObserver;\n\n\t// eslint-disable-next-line @typescript-eslint/ban-types\n\tconstructor(@Inject(PLATFORM_ID) private platformId: object) {\n\t\tthis.isBrowser = isPlatformBrowser(this.platformId);\n\t\tthis.hasIntersectionObserver = DeferLoadService.checkIntersectionObserver();\n\t\tconst observable = this.scrollSubject.asObservable();\n\t\tthis.scrollObservable =\n\t\t\tmerge(\n\t\t\t\tobservable.pipe(throttleTime(300)),\n\t\t\t\tobservable.pipe(debounceTime(100))\n\t\t\t);\n\t\tthis.scrollObservable\n\t\t\t.subscribe(x => {\n\t\t\t\tthis.scrollNotify.emit(x);\n\t\t\t});\n\t\tthis.currentViewport = Rect.fromWindow(window);\n\t}\n\n\tgetObserver(): IntersectionObserver {\n\t\tif (this.intersectionObserver) {\n\t\t\treturn this.intersectionObserver;\n\t\t}\n\t\tthis.intersectionObserver = new IntersectionObserver(entries => {\n\t\t\tthis.observeNotify.next(entries);\n\t\t}, {threshold: 0});\n\t\treturn this.intersectionObserver;\n\t}\n\n\tnotifyScroll(event: ScrollEvent): void {\n\t\tif (this.hasIntersectionObserver) {\n\t\t\treturn;\n\t\t}\n\t\tconst rect = event.element ? Rect.fromElement(event.element) : Rect.fromWindow(window);\n\t\tconst height = (rect.bottom - rect.top);\n\t\trect.bottom += height;\n\t\trect.top -= height;\n\t\tthis.currentViewport = rect;\n\t\tthis.scrollSubject.next({rect});\n\t}\n\n\tprivate static checkIntersectionObserver(): boolean {\n\t\tconst hasIntersectionObserver = 'IntersectionObserver' in window;\n\t\tconst userAgent = window.navigator.userAgent;\n\t\tconst matches = userAgent.match(/Edge\\/(\\d*)\\./i);\n\t\tconst isEdge = !!matches && matches.length > 1;\n\t\tconst isEdgeVersion16OrBetter = isEdge && (!!matches && parseInt(matches[1], 10) > 15);\n\t\treturn hasIntersectionObserver && (!isEdge || isEdgeVersion16OrBetter);\n\t}\n\n}\n","import {Builder} from './builder';\nimport {safeGetStone, Stone} from './stone';\nimport {Mapping} from './types';\n\ninterface StoneGroup {\n\tgroup: number;\n\tstones: Array<Stone>;\n}\n\ninterface Hints {\n\tgroups: Array<StoneGroup>;\n\tcurrent?: StoneGroup;\n}\n\nexport class Board {\n\tbuilder: Builder = new Builder();\n\tfree: Array<Stone> = [];\n\tstones: Array<Stone> = [];\n\tcount = 0;\n\thints: Hints = {groups: [], current: undefined};\n\tselected?: Stone = undefined;\n\n\tclearSelection(): void {\n\t\tif (this.selected) {\n\t\t\tthis.selected.selected = false;\n\t\t}\n\t\tthis.selected = undefined;\n\t}\n\n\tsetStoneSelected(stone?: Stone): void {\n\t\tthis.clearSelection();\n\t\tif (stone) {\n\t\t\tstone.selected = true;\n\t\t\tthis.selected = stone;\n\t\t}\n\t}\n\n\tclearHints(): void {\n\t\tif (this.hints.current) {\n\t\t\tthis.hints.current.stones.forEach((stone: Stone) => {\n\t\t\t\tstone.hinted = false;\n\t\t\t});\n\t\t}\n\t\tthis.hints = {\n\t\t\tgroups: [],\n\t\t\tcurrent: undefined\n\t\t};\n\t}\n\n\thint(): void {\n\t\tif (this.hintNext()) {\n\t\t\treturn;\n\t\t}\n\t\tthis.clearHints();\n\t\tif (this.free.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tconst groups: Array<StoneGroup> = this.collectHints();\n\t\tif (this.selected) {\n\t\t\tconst prefer = this.selected.groupnr;\n\t\t\tgroups.sort((a: StoneGroup, b: StoneGroup) => {\n\t\t\t\tif (a.group === prefer) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\tif (b.group === prefer) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t});\n\t\t}\n\t\tconst current = groups[0];\n\t\tthis.hints = {groups, current};\n\t\tcurrent.stones.forEach((stone: Stone) => {\n\t\t\tstone.hinted = true;\n\t\t});\n\t}\n\n\treset(): void {\n\t\tthis.clearSelection();\n\t\tthis.clearHints();\n\t\tthis.free = [];\n\t\tthis.count = 0;\n\t\tthis.stones = [];\n\t}\n\n\tupdate(): void {\n\t\tconst canRemove = (stone: Stone): boolean =>\n\t\t\tstone.group.filter((_stone: Stone) =>\n\t\t\t\t!_stone.picked && !_stone.isBlocked()).length > 0;\n\n\t\tconst free: Array<Stone> = [];\n\t\tlet count = 0;\n\t\tthis.stones.forEach((stone: Stone) => {\n\t\t\tstone.state = {\n\t\t\t\tblocked: !stone.picked && stone.isBlocked(),\n\t\t\t\tremovable: false\n\t\t\t};\n\t\t\tcount += stone.picked ? 0 : 1;\n\t\t});\n\t\tthis.stones.forEach(stone => {\n\t\t\tstone.state.removable = !stone.picked && !stone.state.blocked && canRemove(stone);\n\t\t\tif (stone.state.removable) {\n\t\t\t\tfree.push(stone);\n\t\t\t}\n\t\t});\n\t\tthis.free = free;\n\t\tthis.count = count;\n\t}\n\n\tload(mapping: Mapping, undos: Array<Array<number>>): void {\n\t\tif (!mapping) {\n\t\t\treturn;\n\t\t}\n\t\tconst stones = this.builder.build('load', mapping);\n\t\tif (!stones) {\n\t\t\treturn;\n\t\t}\n\t\tundos.forEach((undo: Array<number>) => {\n\t\t\tconst stone: Stone | undefined = safeGetStone(stones, undo[0], undo[1], undo[2]);\n\t\t\tif (stone) {\n\t\t\t\tstone.picked = true;\n\t\t\t}\n\t\t});\n\t\tthis.stones = stones;\n\t}\n\n\tsave(): Array<Array<number>> {\n\t\treturn this.stones.map((stone: Stone) =>\n\t\t\t[stone.z, stone.x, stone.y, stone.v]);\n\t}\n\n\tapplyMapping(mapping: Mapping, mode: string): void {\n\t\tthis.stones = this.builder.build(mode, mapping) || [];\n\t}\n\n\tprivate hintNext(): boolean {\n\t\tif (!this.hints.current) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.hints.current.stones.forEach((stone: Stone) => {\n\t\t\tstone.hinted = false;\n\t\t});\n\t\tlet i = this.hints.groups.indexOf(this.hints.current);\n\t\tif (i >= 0) {\n\t\t\ti++;\n\t\t\tif (i >= this.hints.groups.length) {\n\t\t\t\ti = 0;\n\t\t\t}\n\t\t\tif (i < this.hints.groups.length) {\n\t\t\t\tthis.hints.current = this.hints.groups[i];\n\t\t\t\tthis.hints.current.stones.forEach(stone => {\n\t\t\t\t\tstone.hinted = true;\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate collectHints(): Array<StoneGroup> {\n\t\tconst hash: { [index: string]: Array<Stone> } = {};\n\t\tthis.free.forEach((stone: Stone) => {\n\t\t\tconst gn = stone.groupnr.toString();\n\t\t\thash[gn] = hash[gn] || [];\n\t\t\thash[gn].push(stone);\n\t\t});\n\t\treturn Object.keys(hash).map((key: string) =>\n\t\t\t({group: hash[key][0].groupnr, stones: hash[key]}));\n\t}\n}\n","import {TILES} from './consts';\n\nexport interface Tile {\n\tv: number;\n\tgroupnr: number;\n\timg: { id: string };\n}\n\nexport interface TileGroup {\n\tv: number;\n\ttiles: Array<Tile>;\n}\n\nexport class Tiles {\n\tlist: Array<Tile> = [];\n\tgroups: Array<TileGroup> = [];\n\n\tconstructor() {\n\t\tlet v = 0;\n\t\tconst tilesMapping = TILES.map(row => row.map(id => ({id})));\n\t\ttilesMapping.forEach((group, groupnr) => {\n\t\t\tconst g: TileGroup = {v: groupnr, tiles: []};\n\t\t\tthis.groups.push(g);\n\t\t\tgroup.forEach(img => {\n\t\t\t\tv++;\n\t\t\t\tconst tile = {groupnr, v, img};\n\t\t\t\tg.tiles.push(tile);\n\t\t\t\tthis.list[v] = tile;\n\t\t\t});\n\t\t});\n\t}\n}\n","import {HttpClient} from '@angular/common/http';\nimport {Injectable} from '@angular/core';\n\ninterface CacheItem {\n\tdata?: string;\n\trequest?: Promise<string>;\n}\n\n@Injectable()\nexport class SvgdefService {\n\n\tprivate cache: { [name: string]: CacheItem } = {};\n\n\tconstructor(private http: HttpClient) {\n\t}\n\n\tasync get(name: string): Promise<string> {\n\t\tlet item = this.cache[name];\n\t\tif (item) {\n\t\t\tif (item.data) {\n\t\t\t\treturn item.data;\n\t\t\t}\n\t\t\tif (item.request) {\n\t\t\t\treturn item.request;\n\t\t\t}\n\t\t}\n\t\titem = {};\n\t\tconst request = new Promise<string>((resolve, reject) => {\n\t\t\tthis.http.get(`assets/svg/${name}.svg`, {responseType: 'text'})\n\t\t\t\t.subscribe(res => {\n\t\t\t\t\titem.data = res;\n\t\t\t\t\titem.request = undefined;\n\t\t\t\t\tresolve(res);\n\t\t\t\t}, err => {\n\t\t\t\t\treject(err);\n\t\t\t\t});\n\t\t});\n\t\titem.request = request;\n\t\tthis.cache[name] = item;\n\t\treturn request;\n\t}\n\n}\n","// [x, [x, amount (with 2 steps each) ]]\nexport interface CompactMappingX extends Array<number | Array<number>> {\n}\n\n// [y, [SuperCompactMappingX]]\nexport interface CompactMappingY extends Array<number | CompactMappingX> {\n}\n\n// [z, [SuperCompactMappingY]]\nexport interface CompactMappingZ extends Array<number | Array<CompactMappingY>> {\n}\n\n// [SuperCompactMappingZ]\nexport interface CompactMapping extends Array<CompactMappingZ> {\n}\n\n// [z, x, y]\nexport interface Place extends Array<number> {\n}\n\nexport interface Mapping extends Array<Place> {\n}\n\nexport interface Layout {\n\tid: string;\n\tname: string;\n\tcategory: string;\n\tmapping: Mapping;\n\tpreviewSVG?: any;\n}\n\nexport interface Layouts {\n\titems: Array<Layout>;\n}\n\nexport interface LayoutScoreStore {\n\tplayCount?: number;\n\tbestTime?: number;\n}\n\nexport interface LoadLayout {\n\tname: string;\n\tid?: string;\n\tcat?: string;\n\tmapping?: Mapping;\n\tmap?: CompactMapping;\n}\n\nexport interface ImportLayout {\n\tname: string;\n\tby?: string;\n\tcat: string;\n\tmapping: Mapping;\n}\n\nexport interface StorageProvider {\n\n\tgetScore(id: string): LayoutScoreStore | undefined;\n\n\tgetSettings(): SettingsStore | undefined;\n\n\tgetState(): GameStateStore | undefined;\n\n\tstoreScore(id: string, store?: LayoutScoreStore): void;\n\n\tstoreSettings(store?: SettingsStore): void;\n\n\tstoreState(store?: GameStateStore): void;\n}\n\nexport class GameStateStore {\n\telapsed?: number;\n\tstate?: number;\n\tlayout: string;\n\tundo?: Array<Array<number>>;\n\tstones?: Array<Array<number>>;\n}\n\nexport class SettingsStore {\n\tlang: string;\n\tsounds: boolean;\n\ttileset: string;\n\tbackground: string;\n}\n","import {ChangeDetectionStrategy, Component, Input, OnChanges, SimpleChanges} from '@angular/core';\nimport {Layout} from '../../model/types';\n\n@Component({\n\tselector: 'app-layout-preview',\n\ttemplateUrl: './layout-preview.component.html',\n\tstyleUrls: ['./layout-preview.component.scss'],\n\tchangeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class LayoutPreviewComponent implements OnChanges {\n\t@Input() layout: Layout;\n\tsvg: any;\n\n\tngOnChanges(changes: SimpleChanges): void {\n\t\tif (changes.layout) {\n\t\t\tthis.updateLayout(changes.layout.currentValue);\n\t\t}\n\t}\n\n\tprivate updateLayout(layout: Layout): void {\n\t\tthis.svg = layout.previewSVG;\n\t}\n\n}\n","<img [src]=\"svg\">\n","export * from './defer-load.service';\nexport * from './defer-load.module';\n","\nexport const LANG_EN = {\n\tRESTART: 'New Game',\n\tUNDO: 'Undo',\n\tPAUSE: 'Pause',\n\tHINT: 'Hint',\n\tSTONES: 'Stones',\n\tFREE: 'Free',\n\tFULLSCREEN: 'Fullscreen',\n\tHINT_LONG: 'Show possible moves',\n\tUNDO_LONG: 'Undo last move',\n\tRESTART_LONG: 'Start a new game',\n\tPAUSE_LONG: 'Continue/Pause game',\n\tMSG_CONTINUE_PAUSE: 'Continue Game…',\n\tMSG_CONTINUE_SAVE: 'Continue Saved Game…',\n\tMSG_START: 'Start Game',\n\tMSG_PLAY_AGAIN: 'Play again',\n\tMSG_BEST: 'Congratulations, new best time!',\n\tMSG_GOOD: 'Well done!',\n\tMSG_FAIL: 'No more matching tiles.',\n\tSTATS_GAMES: 'Nr. of Games',\n\tSTATS_BEST: 'Best Time',\n\tLICENSE: 'License',\n\tSHORTCUTS: 'Shortcuts',\n\tSETTINGS: 'Settings',\n\tSTATS: 'Stats',\n\tMODE: 'Board Fill Algorithm',\n\tMODE_SOLVABLE: 'Solvable',\n\tMODE_LINEAR: 'Linear',\n\tMODE_RANDOM: 'Random',\n\tAUDIO: 'Audio',\n\tAUDIO_SOUNDS: 'Sounds on/off',\n\tAUDIO_MUSIC: 'Music',\n\tLANG: 'Language',\n\tLANG_EN: 'English',\n\tLANG_KR: 'Korean',\n\tLANG_AUTO: '[Default]',\n\tOPEN_SETTINGS: 'Click here to open the settings',\n\tOPEN_HELP: 'Click here to open the help dialog',\n\tREAD_MORE_WIKIPEDIA: 'Read more on wikipedia',\n\tREAD_MORE_WIKIPEDIA_URL: 'https://en.wikipedia.org/wiki/Mahjong_tiles',\n\tTILES_INFO: 'Tiles Information',\n\tTILES: 'Tiles',\n\tMODE_SOLVABLE_DESC: 'A random fill with at least one solving possibility',\n\tMODE_RANDOM_DESC: 'A total random fill, maybe unsolvable',\n\tMODE_LINEAR_DESC: 'A backwards fill, always solvable, maybe boring to experienced players',\n\tSELECT_BOARD: 'Select Board',\n\tBOARD_GENERATOR: 'Board Generator',\n\tSTART_SELECTED: 'Start Selected',\n\tSTART_RANDOM: 'Start Random',\n\tTILESET: 'Tileset Art',\n\tBACKGROUND: 'Background',\n\tINFO: 'Info',\n\tBEST_TIMES: 'Best Times',\n\tBEST_TIMES_CLEAR: 'Clear Best Times',\n\tBEST_TIMES_CLEAR_SURE: 'Clear All Best Times?\\nThis cannot be undone.',\n\tBEST_TIME_CLEAR: 'Clear Best Time',\n\tBEST_TIME_CLEAR_SURE: 'Clear Best Time?\\nThis cannot be undone.'\n};\n\nexport const LANG_KR = {\n\tRESTART: '새 게임',\n\tUNDO: '되돌리기',\n\tPAUSE: '일시정지',\n\tHINT: '힌트',\n\tSTONES: '타일',\n\tFREE: '매치',\n\tFULLSCREEN: '풀스크린',\n\tSETTINGS: '설정',\n\tSTATS: 'Stats',\n\tMODE: 'Board Fill Algorithm',\n\tMODE_SOLVABLE: 'Solvable',\n\tMODE_LINEAR: 'Linear',\n\tMODE_RANDOM: 'Random',\n\tAUDIO: '소리',\n\tAUDIO_SOUNDS: '소리 on/off',\n\tAUDIO_MUSIC: '음악',\n\tLANG: '언어',\n\tLANG_EN: '영어',\n\tLANG_KR: '한국어',\n\tLANG_AUTO: '[Default]',\n\tOPEN_SETTINGS: '설정을 열려면 여기를 클릭하십시오',\n\tOPEN_HELP: '도움말 상자를 열려면 여기를 클릭하십시오',\n\tREAD_MORE_WIKIPEDIA: 'Read more on wikipedia',\n\tREAD_MORE_WIKIPEDIA_URL: 'https://en.wikipedia.org/wiki/Mahjong_tiles',\n\tTILES_INFO: '타일 정보',\n\tTILES: '타일',\n\tMODE_SOLVABLE_DESC: '하나 이상의 해결 가능성이 있는 랜덤 채우기',\n\tMODE_RANDOM_DESC: '전체 랜덤 채우기, 해결할 수 없을 수 있음',\n\tMODE_LINEAR_DESC: '언제나 해결가능, 경험이 많은 선수들에게는 지루할 수도 있다',\n\tSELECT_BOARD: '보드 선택',\n\tBOARD_GENERATOR: '보드 생성기',\n\tSTART_SELECTED: '선택 시작',\n\tSTART_RANDOM: '랜덤 시작',\n\tTILESET: '타일 사진',\n\tBACKGROUND: '배경화면',\n\tINFO: '정보',\n\tBEST_TIMES: '최고 기록',\n\tBEST_TIMES_CLEAR: '최고 기록 초기화',\n\tBEST_TIMES_CLEAR_SURE: '최고 기록을 초기화 하시겠습니까?',\n\tBEST_TIME_CLEAR: '최고 기록 초기화',\n\tBEST_TIME_CLEAR_SURE: '최고 기록을 초기화 하시겠습니까?'\n};\n","import {Component, HostListener, Input} from '@angular/core';\nimport {Game} from '../../model/game';\nimport {Stone} from '../../model/stone';\nimport {Layout, Layouts} from '../../model/types';\nimport {AppService} from '../../service/app.service';\n\ninterface DocEx extends Document {\n\tfullScreen: boolean;\n\tfullscreen: boolean;\n\tmozFullScreen: boolean;\n\twebkitIsFullScreen: boolean;\n\n\tmozCancelFullScreen(): void;\n\n\twebkitExitFullscreen(): void;\n}\n\ninterface ElemEx extends HTMLElement {\n\twebkitRequestFullScreen(): void;\n\n\tmozRequestFullScreen(): void;\n}\n\n@Component({\n\tselector: 'app-game-component',\n\ttemplateUrl: './game-component.component.html',\n\tstyleUrls: ['./game-component.component.scss']\n})\nexport class GameComponent {\n\t@Input() layouts: Layouts;\n\tgame: Game;\n\ttilesInfoVisible: boolean = false;\n\thelpVisible: boolean = false;\n\tsettingsVisible: boolean = false;\n\tnewGameVisible: boolean = false;\n\n\tconstructor(public app: AppService) {\n\t\tthis.game = app.game;\n\t\tif (this.game.isIdle()) {\n\t\t\tthis.newGameVisible = true;\n\t\t}\n\t}\n\n\t@HostListener('document:keydown', ['$event'])\n\thandleKeyDownEvent(event: KeyboardEvent): void {\n\t\tif (this.helpVisible) {\n\t\t\tif (event.keyCode === 27) {\n\t\t\t\tthis.toggleHelp();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (this.newGameVisible) {\n\t\t\tif (event.keyCode === 27) {\n\t\t\t\tthis.newGameVisible = !this.newGameVisible;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (this.tilesInfoVisible) {\n\t\t\tif (event.keyCode === 27) {\n\t\t\t\tthis.toggleTilesInfo();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (this.settingsVisible) {\n\t\t\tif (event.keyCode === 27) {\n\t\t\t\tthis.toggleSettings();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tswitch (event.which) {\n\t\t\tcase 72: // h\n\t\t\t\tthis.toggleHelp();\n\t\t\t\tbreak;\n\t\t\tcase 73: // i\n\t\t\t\tthis.toggleTilesInfo();\n\t\t\t\tbreak;\n\t\t\tcase 83: // s\n\t\t\t\tthis.toggleSettings();\n\t\t\t\tbreak;\n\t\t\tcase 84: // t\n\t\t\t\tthis.game.hint();\n\t\t\t\tbreak;\n\t\t\tcase 85: // u\n\t\t\t\tthis.game.back();\n\t\t\t\tbreak;\n\t\t\tcase 78: // n\n\t\t\t\tthis.game.pause();\n\t\t\t\tthis.newGameVisible = true;\n\t\t\t\tbreak;\n\t\t\tcase 32: // space\n\t\t\tcase 80: // p\n\t\t\t\tif (this.game.isRunning()) {\n\t\t\t\t\tthis.game.pause();\n\t\t\t\t} else if (this.game.isPaused()) {\n\t\t\t\t\tthis.game.resume();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tstoneClick(stone: Stone): void {\n\t\tthis.game.click(stone);\n\t}\n\n\tenterFullScreen(): void {\n\t\tconst doc = window.document as DocEx;\n\t\tif (doc.fullScreen || doc.fullscreen || doc.mozFullScreen || doc.webkitIsFullScreen) {\n\t\t\tif (doc.exitFullscreen) {\n\t\t\t\tdoc.exitFullscreen()\n\t\t\t\t\t.catch(e => {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t});\n\t\t\t} else if (doc.mozCancelFullScreen) {\n\t\t\t\tdoc.mozCancelFullScreen();\n\t\t\t} else if (doc.webkitExitFullscreen) {\n\t\t\t\tdoc.webkitExitFullscreen();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tconst elem = document.body as ElemEx; // this.el.nativeElement;\n\t\tif (elem.requestFullscreen) {\n\t\t\telem.requestFullscreen()\n\t\t\t\t.catch(e => {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t});\n\t\t} else if (elem.webkitRequestFullScreen) {\n\t\t\telem.webkitRequestFullScreen();\n\t\t} else if (elem.mozRequestFullScreen) {\n\t\t\telem.mozRequestFullScreen();\n\t\t}\n\t}\n\n\tnewGame(): void {\n\t\tthis.game.pause();\n\t\tthis.newGameVisible = true;\n\t}\n\n\tstartGame(data: { layout: Layout; mode: string }): void {\n\t\tthis.newGameVisible = false;\n\t\tthis.game.reset();\n\t\tthis.game.start(data.layout, data.mode);\n\t}\n\n\ttoggleNewGame(): void {\n\t\t// if (!this.game.isIdle()) {\n\t\t\tthis.newGameVisible = !this.newGameVisible;\n\t\t// }\n\t}\n\n\ttoggleTilesInfo(): void {\n\t\tthis.tilesInfoVisible = !this.tilesInfoVisible;\n\t}\n\n\ttoggleSettings(): void {\n\t\tthis.settingsVisible = !this.settingsVisible;\n\t\tif (!this.settingsVisible) {\n\t\t\tthis.app.settings.save();\n\t\t}\n\t}\n\n\ttoggleHelp(): void {\n\t\tthis.helpVisible = !this.helpVisible;\n\t}\n\n\tclickMessage(): void {\n\t\tif (this.game.isPaused()) {\n\t\t\tthis.game.resume();\n\t\t} else {\n\t\t\tthis.game.reset();\n\t\t\tthis.newGameVisible = true;\n\t\t}\n\t}\n\n\t// debugCheat(): void {\n\t// \t(this.game as any).gameOverWining();\n\t// }\n\n}\n","<div class=\"controls controls-top\">\n\t<div class=\"ctrl ctrl-name\">\n\t\t<span class=\"link button\" (click)=\"toggleHelp()\" title=\"{{'OPEN_HELP' | translate}}\">🦊<span class=\"name\">{{app.name}}</span></span>\n\t</div>\n\t<div class=\"ctrl ctrl-game\">\n\t\t<span class=\"link button\" (click)=\"enterFullScreen()\" title=\"{{'FULLSCREEN' | translate}}\">\n\t\t\t<i class=\"icon-resize-full-alt\"></i> <span class=\"label\">{{'FULLSCREEN' | translate}}</span>\n\t\t</span>\n\t\t<span class=\"link button\" (click)=\"game.toggle()\" title=\"{{'PAUSE_LONG' | translate}}\">\n\t\t\t<i class=\"icon-pause\"></i> <span class=\"label\">{{'PAUSE' | translate}}</span>\n\t\t</span>\n\t\t<span class=\"link button\" (click)=\"game.back()\" title=\"{{'UNDO_LONG' | translate}}\" [attr.disabled]=\"game.undo.length==0 ? true : null\">\n\t\t\t<i class=\"icon-undo\"></i> <span class=\"label\">{{'UNDO' | translate}}</span>\n\t\t</span>\n\t\t<span class=\"link button\" (click)=\"game.hint()\" title=\"{{'HINT_LONG' | translate}}\">\n\t\t\t<i class=\"icon-lightbulb\"></i> <span class=\"label\">{{'HINT' | translate}}</span>\n\t\t</span>\n\t\t<span class=\"link button\" (click)=\"newGame()\" title=\"{{'RESTART_LONG' | translate}}\">\n\t\t\t<i class=\"icon-loop\"></i> <span class=\"label\">{{'RESTART' | translate}}</span>\n\t\t</span>\n\t</div>\n</div>\n<app-board class=\"board\" [tiles]=\"game.board.stones\" [imageSet]=\"app.settings.tileset\" [background]=\"app.settings.background\" (clickEvent)=\"stoneClick($event)\"></app-board>\n<div class=\"controls controls-bottom\">\n\t<div class=\"ctrl ctrl-stats\">\n\t\t<span class=\"link button\" (click)=\"toggleSettings()\" title=\"{{'OPEN_SETTINGS' | translate}}\">\n\t\t\t<i class=\"icon-cog\"></i>\n\t\t</span>\n\t\t<span class=\"link button\" [class.inactive]=\"!app.settings.sounds\" (click)=\"app.toggleSound()\" title=\"{{'AUDIO_SOUNDS'|translate}}\">\n\t\t\t<i class=\"icon-volume-low\"></i>\n\t\t</span>\n\t\t<span class=\"link button\" (click)=\"toggleTilesInfo()\" title=\"{{'TILES_INFO' | translate}}\">\n\t\t\t<i class=\"icon-calendar\"></i>\n\t\t</span>\n\t\t<span class=\"label button\"><small>{{'STONES' | translate}}</small>: <span>{{game.board.count}}</span></span>\n\t\t<span class=\"label button\"><small>{{'FREE' | translate}}</small>: <span>{{game.board.free.length}}</span></span>\n<!--\t\t<span class=\"label button\" (click)=\"debugCheat()\">CHEAT</span>-->\n\t</div>\n\t<div class=\"ctrl ctrl-time\">\n\t\t<span>{{game.clock.elapsed | duration}}</span>\n\t</div>\n</div>\n\n<div *ngIf=\"helpVisible\" class=\"overlay overlay-help\" (click)=\"toggleHelp();\">\n\t<div class=\"overlay-popup\" (click)=\"$event.stopPropagation();\">\n\t\t<span class=\"close\" (click)=\"toggleHelp()\"><i class=\"icon-cancel-circled2 pull-right\"></i></span>\n\t\t<app-help></app-help>\n\t</div>\n</div>\n<div *ngIf=\"settingsVisible\" class=\"overlay overlay-settings\" (click)=\"toggleSettings();\">\n\t<div class=\"overlay-popup\" (click)=\"$event.stopPropagation();\">\n\t\t<span class=\"close\" (click)=\"toggleSettings()\"><i class=\"icon-cancel-circled2 pull-right\"></i></span>\n\t\t<app-settings></app-settings>\n\t</div>\n</div>\n<div *ngIf=\"game.message\" class=\"overlay overlay-message\" (click)=\"clickMessage();\">\n\t<div class=\"overlay-popup\">\n\t\t<div *ngIf=\"game.message.msgID\">{{game.message.msgID | translate}}</div>\n\t\t<div *ngIf=\"game.message.playTime\">{{game.message.playTime | duration}}</div>\n\t</div>\n</div>\n<div *ngIf=\"tilesInfoVisible\" class=\"overlay overlay-tiles-info\" (click)=\"toggleTilesInfo();\">\n\t<div class=\"overlay-popup\" (click)=\"$event.stopPropagation();\">\n\t\t<span class=\"close\" (click)=\"toggleTilesInfo()\"><i class=\"icon-cancel-circled2 pull-right\"></i></span>\n\t\t<app-tiles-info [imageSet]=\"app.settings.tileset\"></app-tiles-info>\n\t</div>\n</div>\n<div *ngIf=\"layouts && newGameVisible\" (click)=\"toggleNewGame();\" class=\"overlay overlay-newgame\">\n\t<div class=\"overlay-popup\" (click)=\"$event.stopPropagation();\">\n\t\t<span class=\"close\" (click)=\"toggleNewGame();\"><i class=\"icon-cancel-circled2 pull-right\"></i></span>\n\t\t<app-choose-layout class=\"choose\" [layouts]=\"layouts\" (startEvent)=\"startGame($event)\"></app-choose-layout>\n\t</div>\n</div>\n","import {Component} from '@angular/core';\nimport {Meta} from '@angular/platform-browser';\nimport {TranslateService} from '@ngx-translate/core';\nimport {Layouts} from './model/types';\nimport {AppService} from './service/app.service';\nimport {LayoutService} from './service/layout.service';\nimport {LocalstorageService} from './service/localstorage.service';\n\n@Component({\n\tselector: 'app-root',\n\ttemplateUrl: './app.component.html',\n\tstyleUrls: ['./app.component.scss']\n})\nexport class AppComponent {\n\tlayouts: Layouts;\n\tloading = true;\n\n\tconstructor(private layoutService: LayoutService, private storage: LocalstorageService, private translate: TranslateService, private meta: Meta, public app: AppService) {\n\t\tthis.updateName();\n\t\tthis.loadLayouts();\n\t\tthis.registerWindowListeners();\n\t}\n\n\tprivate loadLayouts(): void {\n\t\tthis.layoutService.get().then(\n\t\t\tdata => {\n\t\t\t\tthis.layouts = data;\n\t\t\t\tthis.loading = false;\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\tconsole.error(e);\n\t\t\t});\n\t}\n\n\tprivate registerWindowListeners(): void {\n\t\t// does not work:\n\t\t// @HostListener('window:onbeforeunload')\n\t\t// public onBeforeUnload() {}\n\t\t// => old style!\n\t\twindow.addEventListener('beforeunload', () => {\n\t\t\tif (this.app.game.isRunning()) {\n\t\t\t\tthis.app.game.pause();\n\t\t\t}\n\t\t}, false);\n\t\twindow.addEventListener('blur', () => {\n\t\t\tif (this.app.game.isRunning()) {\n\t\t\t\tthis.app.game.pause();\n\t\t\t}\n\t\t}, false);\n\t}\n\n\tprivate updateName(): void {\n\t\tconst tag = this.meta.getTag('name=application-name');\n\t\tthis.app.name = tag ? tag.content : this.app.name;\n\t}\n\n}\n","<app-game-component [hidden]=\"loading\" [layouts]=\"layouts\"></app-game-component>\n","import {HttpClientModule} from '@angular/common/http';\nimport {NgModule} from '@angular/core';\nimport {FormsModule} from '@angular/forms';\nimport {BrowserModule} from '@angular/platform-browser';\nimport {TranslateModule} from '@ngx-translate/core';\n\nimport {AppComponent} from './app.component';\nimport {BoardComponent} from './components/board/board.component';\nimport {ChooseLayoutComponent} from './components/choose-layout/choose-layout.component';\nimport {GameComponent} from './components/game/game-component.component';\nimport {HelpComponent} from './components/help/help.component';\nimport {ImageSetLoaderComponent} from './components/image-set-loader/image-set-loader.component';\nimport {LayoutPreviewComponent} from './components/layout-preview/layout-preview.component';\nimport {SettingsComponent} from './components/settings/settings.component';\nimport {TileComponent} from './components/tile/tile.component';\nimport {TilesInfoComponent} from './components/tiles-info/tiles-info.component';\nimport {DropZoneDirective} from './directives/drop-zone.directive';\nimport {DeferLoadModule} from './modules/defer-load';\nimport {DurationPipe} from './pipes/duration.pipe';\nimport {PrefixPipe} from './pipes/prefix.pipe';\nimport {AppService} from './service/app.service';\nimport {LayoutService} from './service/layout.service';\nimport {SvgdefService} from './service/svgdef.service';\n\n@NgModule({\n\timports: [\n\t\tBrowserModule,\n\t\tFormsModule,\n\t\tHttpClientModule,\n\t\tDeferLoadModule.forRoot(),\n\t\tTranslateModule.forRoot()\n\t],\n\tdeclarations: [\n\t\tAppComponent,\n\t\tChooseLayoutComponent,\n\t\tGameComponent,\n\t\tHelpComponent,\n\t\tLayoutPreviewComponent,\n\t\tBoardComponent,\n\t\tDurationPipe,\n\t\tPrefixPipe,\n\t\tTilesInfoComponent,\n\t\tTileComponent,\n\t\tImageSetLoaderComponent,\n\t\tSettingsComponent,\n\t\tDropZoneDirective\n\t],\n\tproviders: [\n\t\tAppService,\n\t\tLayoutService,\n\t\tSvgdefService\n\t],\n\tbootstrap: [AppComponent]\n})\nexport class AppModule {\n}\n","export class Clock {\n\telapsed = 0;\n\tprivate lastTime = 0;\n\tprivate started = 0;\n\tprivate timer?: number = undefined;\n\n\tstart(): void {\n\t\tif (!this.timer) {\n\t\t\tthis.elapsed = this.elapsed || 0;\n\t\t}\n\t}\n\n\treset(): void {\n\t\tif (this.timer) {\n\t\t\twindow.clearTimeout(this.timer);\n\t\t\tthis.timer = undefined;\n\t\t}\n\t\tthis.started = 0;\n\t\tthis.lastTime = 0;\n\t\tthis.elapsed = 0;\n\t}\n\n\trun(): void {\n\t\tif (this.timer) {\n\t\t\treturn;\n\t\t}\n\t\tthis.lastTime = Date.now();\n\t\tthis.timer = window.setTimeout(() => {\n\t\t\tthis.step();\n\t\t}, 1000);\n\t}\n\n\tpause(): void {\n\t\tif (!this.timer) {\n\t\t\treturn;\n\t\t}\n\t\twindow.clearTimeout(this.timer);\n\t\tthis.timer = undefined;\n\t\tconst newtime = Date.now();\n\t\tthis.elapsed += newtime - this.lastTime;\n\t}\n\n\tprivate step(): void {\n\t\tconst newtime = Date.now();\n\t\tthis.elapsed += newtime - this.lastTime;\n\t\tthis.lastTime = newtime;\n\t\tthis.timer = window.setTimeout(() => {\n\t\t\tthis.step();\n\t\t}, 1000);\n\t}\n}\n","import {Pipe, PipeTransform} from '@angular/core';\n\nfunction pad(num: number): string {\n\treturn (num < 10 ? '0' : '') + num.toString();\n}\n\n@Pipe({\n\tname: 'duration'\n})\nexport class DurationPipe implements PipeTransform {\n\ttransform(value: number): string {\n\t\tif (isNaN(value) || (value === 0)) {\n\t\t\treturn '-';\n\t\t}\n\t\tconst secNum = Math.floor(value / 1000);\n\t\tconst hours = Math.floor(secNum / 3600);\n\t\tconst minutes = Math.floor((secNum - (hours * 3600)) / 60);\n\t\tconst seconds = secNum - (hours * 3600) - (minutes * 60);\n\t\treturn `${(hours > 0) ? `${pad(hours)  }:` : ''}${pad(minutes)}:${pad(seconds)}`;\n\t}\n}\n","import {getDrawViewPort, mappingToDrawItems} from './draw';\nimport {Mapping} from './types';\n\nexport function generateStaticLayoutSVG(mapping: Mapping): string {\n\tconst items = mappingToDrawItems(mapping);\n\tconst viewport = getDrawViewPort(items, 1470, 960, false);\n\tconst sl: Array<string> = [];\n\tsl.push(`<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"board-svg\" viewBox=\"${viewport}\" preserveAspectRatio=\"xMidYMid meet\" height=\"100%\" width=\"100%\">`);\n\tfor (const draw of items) {\n\t\tsl.push(`<g transform=\"${draw.pos.translate}\"><rect class=\"stone\" fill=\"#FFF9E5\" stroke-width=\"2\" stroke=\"black\" x=\"0\" y=\"0\" width=\"75\" height=\"100\" rx=\"10\" ry=\"10\"></rect></g>`);\n\t}\n\tsl.push('</svg>');\n\treturn `data:image/svg+xml;base64,${window.btoa(sl.join(''))}`;\n}\n","import {Component, Input} from '@angular/core';\nimport {TILES_INFO} from '../../model/consts';\n\n@Component({\n\tselector: 'app-tiles-info',\n\ttemplateUrl: './tiles-info.component.html',\n\tstyleUrls: ['./tiles-info.component.scss']\n})\nexport class TilesInfoComponent {\n\tinfo = TILES_INFO;\n\t@Input() imageSet: any;\n}\n","<h1>🦊{{'TILES'|translate}}</h1>\n<div class=\"tiles-content\">\n\t<div class=\"tiles-section\" *ngFor=\"let suit of info.suits\">\n\t\t<div class=\"tiles-title\">{{suit.name}}</div>\n\t\t<div class=\"tiles-set-9\">\n\t\t\t<div class=\"tile\" *ngFor=\"let tile of suit.tiles\">\n\t\t\t\t<app-tile [tile]=\"tile.img\" [imageSet]=\"imageSet\"></app-tile>\n\t\t\t\t<div [innerHtml]=\"tile.name\"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class=\"tiles-section-half\" *ngFor=\"let group of [info.bonus, info.honors] \">\n\t\t<div class=\"tiles-section-4\" *ngFor=\"let suit of group\">\n\t\t\t<div class=\"tiles-title\">{{suit.name}}</div>\n\t\t\t<div class=\"tiles-set-4\">\n\t\t\t\t<div class=\"tile\" *ngFor=\"let tile of suit.tiles\">\n\t\t\t\t\t<app-tile [tile]=\"tile.img\" [imageSet]=\"imageSet\"></app-tile>\n\t\t\t\t\t<div [innerHtml]=\"tile.name\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n","import {Pipe, PipeTransform} from '@angular/core';\n\n@Pipe({\n\tname: 'prefix'\n})\nexport class PrefixPipe implements PipeTransform {\n\ttransform(value: string | undefined, prefix: string): string {\n\t\treturn `${prefix}${value}`;\n\t}\n}\n","import {Board} from './board';\nimport {Clock} from './clock';\nimport {STATES} from './consts';\nimport {Sound, SOUNDS} from './sound';\nimport {Stone} from './stone';\nimport {GameStateStore, Layout, StorageProvider} from './types';\n\nexport class Game {\n\tclock: Clock = new Clock();\n\tboard: Board = new Board();\n\tsound: Sound = new Sound();\n// music: Music = new Music();\n\tstate: number = STATES.idle;\n\tmessage?: { msgID?: string; playTime?: number };\n\tlayoutID?: string = undefined;\n\tundo: Array<Array<number>> = [];\n\n\tconstructor(private storage: StorageProvider) {\n\t}\n\n\tinit(): void {\n\t\tthis.load();\n\t\tthis.board.update();\n\t\tif (this.state === STATES.run) {\n\t\t\tthis.pause();\n\t\t}\n\t\tthis.message = {msgID: this.isPaused() ? 'MSG_CONTINUE_SAVE' : 'MSG_START'};\n\t}\n\n\tclick(stone: Stone): boolean {\n\t\tif (!stone) {\n\t\t\tthis.board.clearSelection();\n\t\t\treturn false;\n\t\t}\n\t\tif (!this.isRunning() || stone.state.blocked) {\n\t\t\tthis.sound.play(SOUNDS.NOPE);\n\t\t\treturn true;\n\t\t}\n\t\tif (this.clock.elapsed === 0) {\n\t\t\tthis.clock.run();\n\t\t}\n\t\tif (this.board.selected && stone && stone !== this.board.selected && stone.groupnr === this.board.selected.groupnr) {\n\t\t\tthis.resolveMatchingStone(stone);\n\t\t\treturn true;\n\t\t}\n\t\tif (this.board.selected !== stone) {\n\t\t\tthis.sound.play(SOUNDS.SELECT);\n\t\t}\n\t\tthis.board.setStoneSelected(this.board.selected !== stone ? stone : undefined);\n\t\treturn true;\n\t}\n\n\tisRunning(): boolean {\n\t\treturn this.state === STATES.run;\n\t}\n\n\tisFreezed(): boolean {\n\t\treturn this.state === STATES.freeze;\n\t}\n\n\tisPaused(): boolean {\n\t\treturn this.state === STATES.pause;\n\t}\n\n\tisIdle(): boolean {\n\t\treturn this.state === STATES.idle;\n\t}\n\n\tresume(): void {\n\t\tthis.run();\n\t\tthis.clock.run();\n\t\t// if (this.settings.music) {\n\t\t// \tthis.music.play();\n\t\t// }\n\t}\n\n\tfreeze(): void {\n\t\tthis.setState(STATES.freeze);\n\t\tthis.clock.pause();\n\t}\n\n\tunfreeze(): void {\n\t\tthis.setState(STATES.run);\n\t\tthis.clock.run();\n\t\t// if (this.settings.music) {\n\t\t// \tthis.music.play();\n\t\t// }\n\t}\n\n\trun(): void {\n\t\tthis.board.clearHints();\n\t\tthis.board.update();\n\t\tthis.setState(STATES.run);\n\t}\n\n\thint(): void {\n\t\tthis.board.hint();\n\t}\n\n\ttoggle(): void {\n\t\tif (this.state === STATES.run) {\n\t\t\tthis.pause();\n\t\t} else if (this.state === STATES.pause) {\n\t\t\tthis.resume();\n\t\t}\n\t}\n\n\tpause(): void {\n\t\tthis.clock.pause();\n\t\tthis.setState(STATES.pause, 'MSG_CONTINUE_PAUSE');\n\t\tthis.save();\n\t\t// if (this.settings.music) {\n\t\t// \tthis.music.pause();\n\t\t// }\n\t}\n\n\treset(): void {\n\t\tthis.clock.reset();\n\t\tthis.setState(STATES.idle);\n\t\tthis.board.reset();\n\t\tthis.undo = [];\n\t}\n\n\tstart(layout: Layout, mode: string): void {\n\t\tthis.layoutID = layout.id;\n\t\tthis.board.applyMapping(layout.mapping, mode);\n\t\tthis.board.update();\n\t\tthis.run();\n\t}\n\n\tback(): void {\n\t\tif (!this.isRunning() || (this.undo.length < 2)) {\n\t\t\treturn;\n\t\t}\n\t\tthis.board.clearSelection();\n\t\tthis.board.clearHints();\n\t\tconst n1 = this.undo.pop();\n\t\tconst n2 = this.undo.pop();\n\t\tif (!n1 || !n2) {\n\t\t\treturn;\n\t\t}\n\t\tthis.board.stones.forEach(stone => {\n\t\t\tif ((stone.z === n1[0]) && (stone.x === n1[1]) && (stone.y === n1[2])) {\n\t\t\t\tstone.picked = false;\n\t\t\t} else if ((stone.z === n2[0]) && (stone.x === n2[1]) && (stone.y === n2[2])) {\n\t\t\t\tstone.picked = false;\n\t\t\t}\n\t\t});\n\t\tthis.board.update();\n\t}\n\n\tload(): boolean {\n\t\ttry {\n\t\t\tconst store: GameStateStore | undefined = this.storage.getState();\n\t\t\tif (store && store.stones) {\n\t\t\t\tthis.clock.elapsed = store.elapsed || 0;\n\t\t\t\tthis.undo = store.undo || [];\n\t\t\t\tthis.layoutID = store.layout;\n\t\t\t\tthis.state = store.state || STATES.idle;\n\t\t\t\tthis.board.load(store.stones, this.undo);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error('load state failed', e);\n\t\t}\n\t\treturn false;\n\t}\n\n\tsave(): void {\n\t\ttry {\n\t\t\tthis.storage.storeState({\n\t\t\t\telapsed: this.clock.elapsed,\n\t\t\t\tstate: this.state,\n\t\t\t\tlayout: this.layoutID || '',\n\t\t\t\tundo: this.undo,\n\t\t\t\tstones: this.board.save()\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tconsole.error('storing state failed', e);\n\t\t}\n\t}\n\n\tprivate gameOverLoosing(): void {\n\t\tconst id = this.layoutID || 'unknown';\n\t\tconst score = this.storage.getScore(id) || {};\n\t\tscore.playCount = (score.playCount || 0) + 1;\n\t\tthis.storage.storeScore(id, score);\n\t\tthis.gameOver('MSG_FAIL');\n\t}\n\n\tprivate gameOverWining(): void {\n\t\tconst id = this.layoutID || 'unknown';\n\t\tconst playTime = this.clock.elapsed;\n\t\tconst score = this.storage.getScore(id) || {};\n\t\tscore.playCount = (score.playCount || 0) + 1;\n\t\tif (!score.bestTime || score.bestTime > playTime) {\n\t\t\tscore.bestTime = playTime;\n\t\t\tthis.gameOver('MSG_BEST', playTime);\n\t\t} else {\n\t\t\tthis.gameOver('MSG_GOOD', playTime);\n\t\t}\n\t\tthis.storage.storeScore(id, score);\n\t}\n\n\t// toggleMusic(): void {\n\t// if (!this.settings.music) {\n\t// \tthis.music.stop();\n\t// } else {\n\t// \tthis.music.play();\n\t// }\n\t// }\n\n\tprivate delayedSave(): void {\n\t\tsetTimeout(() => {\n\t\t\tthis.save();\n\t\t}, 500);\n\t}\n\n\tprivate resolveMatchingStone(stone: Stone): void {\n\t\tconst sel = this.board.selected;\n\t\tif (!sel) {\n\t\t\treturn;\n\t\t}\n\t\tthis.board.clearSelection();\n\t\tthis.undo.push([sel.z, sel.x, sel.y], [stone.z, stone.x, stone.y]);\n\t\tthis.board.clearHints();\n\t\tsel.picked = true;\n\t\tstone.picked = true;\n\t\tthis.board.update();\n\t\tif (this.board.count < 2) {\n\t\t\tthis.gameOverWining();\n\t\t} else if (this.board.free.length < 1) {\n\t\t\tthis.gameOverLoosing();\n\t\t} else {\n\t\t\tthis.sound.play(SOUNDS.MATCH);\n\t\t\tthis.delayedSave();\n\t\t}\n\t}\n\n\tprivate gameOver(message: string, playTime?: number): void {\n\t\tthis.sound.play(SOUNDS.OVER);\n\t\tthis.setState(STATES.idle, message, playTime);\n\t\tthis.clock.reset();\n\t\tthis.delayedSave();\n\t}\n\n\tprivate setState(state: number, msgID?: string, playTime?: number): void {\n\t\tthis.message = msgID ? {msgID, playTime} : undefined;\n\t\tthis.state = state;\n\t}\n\n}\n","import {Consts} from './consts';\nimport {Stone} from './stone';\nimport {Mapping} from './types';\n\nexport interface DrawPos {\n\tx: number;\n\ty: number;\n\tz: number;\n\ttranslate: string;\n}\n\nexport interface Draw {\n\tx: number;\n\ty: number;\n\tz: number;\n\tv: number;\n\tpos: DrawPos;\n\tvisible: boolean;\n\turl?: string;\n\tcolor?: string;\n\tsource: Stone;\n}\n\nexport function calcDrawPos(z: number, x: number, y: number): DrawPos {\n\tconst pos = {\n\t\tx: ((Consts.tileWidth + 2) * x / 2 - (z * 8)) + (Consts.tileWidth / 2),\n\t\ty: ((Consts.tileHeight + 2) * y / 2 - (z * 8)) + (Consts.tileHeight / 2),\n\t\tz: y + Consts.mY * (x + Consts.mX * z),\n\t\ttranslate: ''\n\t};\n\tpos.translate = `translate(${pos.x},${pos.y})`;\n\treturn pos;\n}\n\nexport function sortDrawItems(items: Array<Draw>): Array<Draw> {\n\tconst sortToDraw = (draw: Draw) => draw.pos.z;\n\treturn items.sort((ad: Draw, bd: Draw) => {\n\t\tconst a = sortToDraw(ad);\n\t\tconst b = sortToDraw(bd);\n\t\tif (a < b) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (a > b) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t});\n}\n\nexport function getDrawViewPort(items: Array<Draw>, width: number, height: number, rotate: boolean): string {\n\tconst bounds = getDrawBounds(items, width, height);\n\tconst b: Array<number> = rotate ?\n\t\t[-bounds[3] - Consts.tileHeight - 10, -bounds[0] - 30, bounds[3] + Consts.tileHeight - 10, bounds[2] + bounds[0] + Consts.tileWidth + 40] :\n\t\t[bounds[0] - 40, bounds[1] - 20, bounds[2] + Consts.tileHeight + 40, bounds[3] + Consts.tileHeight + 20];\n\treturn b.join(' ');\n}\n\nexport function getDrawBounds(items: Array<Draw>, width: number, height: number): Array<number> {\n\tconst m = Math.max(width, height);\n\tconst bounds = [m, m, 0, 0];\n\titems.forEach(draw => {\n\t\tbounds[0] = Math.min(bounds[0], draw.pos.x);\n\t\tbounds[1] = Math.min(bounds[1], draw.pos.y);\n\t\tbounds[2] = Math.max(bounds[2], draw.pos.x);\n\t\tbounds[3] = Math.max(bounds[3], draw.pos.y);\n\t});\n\treturn bounds;\n}\n\nexport function mappingToDrawItems(mapping: Mapping): Array<Draw> {\n\tconst emptySource: Stone = new Stone(0, 0, 0, 0, 0);\n\tconst result = mapping.map((row: Array<number>): Draw =>\n\t\t({\n\t\t\tz: row[0],\n\t\t\tx: row[1],\n\t\t\ty: row[2],\n\t\t\tv: 0,\n\t\t\tvisible: true,\n\t\t\tpos: calcDrawPos(row[0], row[1], row[2]),\n\t\t\tsource: emptySource\n\t\t}));\n\treturn sortDrawItems(result);\n}\n","export const version = '1.2.0';\n","import {Injectable} from '@angular/core';\nimport {GameStateStore, LayoutScoreStore, SettingsStore, StorageProvider} from '../model/types';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class LocalstorageService implements StorageProvider {\n\n\tprivate readonly prefix = 'mah.';\n\n\tconstructor() {\n\t\tthis.updateData();\n\t}\n\n\tgetScore(id: string): LayoutScoreStore | undefined {\n\t\treturn this.get<LayoutScoreStore>(`score.${id}`);\n\t}\n\n\tgetSettings(): SettingsStore | undefined {\n\t\treturn this.get<SettingsStore>('settings');\n\t}\n\n\tgetState(): GameStateStore | undefined {\n\t\treturn this.get<GameStateStore>('state');\n\t}\n\n\tgetLastPlayed(): string | undefined {\n\t\tif (!localStorage) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tconst result = localStorage.getItem('last');\n\t\t\treturn result || undefined;\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t\treturn;\n\t}\n\n\tstoreLastPlayed(id: string): void {\n\t\tif (!localStorage) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tif (!id) {\n\t\t\t\tlocalStorage.removeItem('last');\n\t\t\t} else {\n\t\t\t\tlocalStorage.setItem('last', id);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t}\n\n\tstoreScore(id: string, store?: LayoutScoreStore): void {\n\t\tthis.set<LayoutScoreStore>(`score.${id}`, store);\n\t}\n\n\tclearScore(id: string): void {\n\t\tthis.set<LayoutScoreStore>(`score.${id}`, undefined);\n\t}\n\n\tstoreSettings(store?: SettingsStore): void {\n\t\tthis.set<SettingsStore>('settings', store);\n\t}\n\n\tstoreState(store?: GameStateStore): void {\n\t\tthis.set<GameStateStore>('state', store);\n\t}\n\n\tprivate get<T>(key: string): T | undefined {\n\t\tif (!localStorage) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tconst s = localStorage.getItem(`${this.prefix}${key}`);\n\t\t\tif (!s) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn JSON.parse(s);\n\t\t} catch (e) {\n\t\t\treturn;\n\t\t}\n\t}\n\n\tprivate set<T>(key: string, data?: T): void {\n\t\tif (!localStorage) {\n\t\t\treturn;\n\t\t}\n\t\tif (data === undefined) {\n\t\t\tlocalStorage.removeItem(`${this.prefix}${key}`);\n\t\t} else {\n\t\t\tlocalStorage.setItem(this.prefix + key, JSON.stringify(data));\n\t\t}\n\t}\n\n\tprivate updateData(): void {\n\t\tif (!localStorage) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tlet old = localStorage.getItem('state');\n\t\t\tif (old) {\n\t\t\t\tlocalStorage.removeItem('state');\n\t\t\t\tthis.set<any>('state', JSON.parse(old));\n\t\t\t}\n\t\t\told = localStorage.getItem('settings');\n\t\t\tif (old) {\n\t\t\t\tlocalStorage.removeItem('settings');\n\t\t\t\tthis.set<any>('settings', JSON.parse(old));\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t}\n\n}\n","import {Component, EventEmitter, HostBinding, Input, OnChanges, OnInit, Output, SimpleChanges} from '@angular/core';\nimport {Backgrounds} from '../../model/consts';\nimport {calcDrawPos, Draw, getDrawViewPort, sortDrawItems} from '../../model/draw';\nimport {Stone} from '../../model/stone';\n\n@Component({\n\tselector: 'app-board',\n\ttemplateUrl: './board.component.html',\n\tstyleUrls: ['./board.component.scss']\n})\nexport class BoardComponent implements OnInit, OnChanges {\n\t@Input() background: string;\n\t@Input() imageSet: string;\n\t@Input() tiles: Array<Stone>;\n\t@Output() readonly clickEvent = new EventEmitter<Stone>();\n\t@HostBinding('style.background-image') backgroundUrl: string | undefined;\n\tdrawStones: Array<Draw> = [];\n\trotate: boolean = false;\n\ttranslate: string = '';\n\tviewport: string = '0 0 1470 960';\n\tprefix: string;\n\turlPrefix: string;\n\n\tngOnInit(): void {\n\t\tthis.resize(window);\n\t}\n\n\ttrackByDrawStone(index: number, draw: Draw): string {\n\t\treturn `${draw.source.groupnr}/${draw.source.v}`;\n\t}\n\n\tngOnChanges(changes: SimpleChanges): void {\n\t\tif (changes.tiles) {\n\t\t\tthis.updateTiles(changes.tiles.currentValue);\n\t\t}\n\t\tif (changes.background) {\n\t\t\tthis.updateBackground(changes.background.currentValue);\n\t\t}\n\t\tif (changes.imageSet) {\n\t\t\tthis.prefix = `b_${changes.imageSet.currentValue}_`;\n\t\t\tthis.urlPrefix = `#b_${changes.imageSet.currentValue}_`;\n\t\t}\n\t}\n\n\tonClick(event: MouseEvent, draw?: Draw): void {\n\t\tthis.clickEvent.emit(draw ? draw.source : undefined);\n\t\tevent.stopPropagation();\n\t}\n\n\tresize(element: { innerHeight: number; innerWidth: number }): void {\n\t\tconst r = element.innerHeight > element.innerWidth;\n\t\tif (r !== this.rotate) {\n\t\t\tthis.rotate = r;\n\t\t\tthis.translate = this.rotate ? 'rotate(90)' : '';\n\t\t\tthis.setViewPort();\n\t\t}\n\t}\n\n\tonResize(event: UIEvent): void {\n\t\tconst element = event.target as Window;\n\t\tif (element) {\n\t\t\tthis.resize(element);\n\t\t}\n\t}\n\n\tprivate setViewPort(): void {\n\t\tthis.viewport = getDrawViewPort(this.drawStones, 1470, 960, this.rotate);\n\t}\n\n\tprivate updateTiles(stones: Array<Stone>): void {\n\t\tif (!stones) {\n\t\t\treturn;\n\t\t}\n\t\tconst items = stones\n\t\t\t.filter((stone: Stone) => (stone !== undefined))\n\t\t\t.map((stone: Stone): Draw =>\n\t\t\t\t({\n\t\t\t\t\tz: stone.z,\n\t\t\t\t\tx: stone.x,\n\t\t\t\t\ty: stone.y,\n\t\t\t\t\tv: stone.v,\n\t\t\t\t\tvisible: true,\n\t\t\t\t\turl: stone.img?.id,\n\t\t\t\t\tpos: calcDrawPos(stone.z, stone.x, stone.y),\n\t\t\t\t\tsource: stone\n\t\t\t\t}));\n\t\tthis.drawStones = sortDrawItems(items);\n\t\tthis.setViewPort();\n\t}\n\n\tprivate updateBackground(background: string): void {\n\t\tconst back = Backgrounds.find(b => b.img === background);\n\t\tthis.backgroundUrl = back && back.img ? `url(\"assets/img/${back.img}\")` : undefined;\n\t}\n}\n","<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"board-svg\" [class.rotate]=\"rotate\" [attr.viewBox]=\"viewport\" preserveAspectRatio=\"xMidYMid meet\" (window:resize)=\"onResize($event)\" (mousedown)=\"onClick($event)\">\n\t<defs>\n\t\t<filter id=\"filter4198-8\" style=\"color-interpolation-filters:sRGB\">\n\t\t\t<feGaussianBlur in=\"SourceGraphic\" stdDeviation=\"8\"/>\n\t\t</filter>\n\t\t<svg id=\"front\" width=\"300\" height=\"400\" viewBox=\"0 0 300 400\">\n\t\t\t<path d=\"m 151.73588,1025.0177 c -3.32683,-9.3138 -10.24843,-68.45389 5.31821,-90.62655 20.27717,-26.12032 219.43558,-16.45796 231.55506,-9.93184 11.07433,5.31702 -178.60366,0.0589 -204.85126,34.86646 -21.59349,30.0006 -26.50086,82.17843 -32.02201,65.69193 z\"\n\t\t\t\t\t\tstyle=\"fill:#000000;fill-opacity:0.15;fill-rule:evenodd;stroke:none;filter:url(#filter4198-8)\"\n\t\t\t\t\t\ttransform=\"rotate(180,228.93649,666.47892)\"/>\n\t\t\t<path transform=\"translate(5.9349307,-644.92912)\"\n\t\t\t\t\t\tstyle=\"fill:#ffffff;fill-opacity:0.4;fill-rule:evenodd;stroke:none;filter:url(#filter4198-8)\"\n\t\t\t\t\t\td=\"M -4.7687833,775.07096 C -9.6501835,741.99485 -16.84552,674.23676 -1.2788716,652.0641 18.998297,625.94378 233.50094,631.63117 263.31435,653.90999 276.21398,662.64856 70.349579,663.12124 47.099353,691.74479 24.390958,719.11242 0.65060847,818.18718 -4.7687833,775.07096 Z\"/>\n\t\t</svg>\n\t</defs>\n\t<defs app-image-set-loader [imageSet]=\"imageSet\" [prefix]=\"prefix\"></defs>\n\t<g class=\"stage\" [attr.transform]=\"translate\">\n\t\t<g *ngFor=\"let draw of drawStones; trackBy:trackByDrawStone\" class=\"draw\"\n\t\t\t [class.selected]=\"draw.source.selected\"\n\t\t\t [class.hidden]=\"draw.source.picked\"\n\t\t\t [class.hinted]=\"draw.source.hinted\"\n\t\t\t [attr.transform]=\"draw.pos.translate\" (mousedown)=\"onClick($event, draw)\">\n\t\t\t<g class=\"tile\">\n\t\t\t\t<rect class=\"shadow\" x=\"3\" y=\"3\" width=\"75px\" height=\"100px\" rx=\"10\" ry=\"10\"></rect>\n\t\t\t\t<rect class=\"stone\" x=\"0\" y=\"0\" width=\"75\" height=\"100\" rx=\"10\" ry=\"10\"></rect>\n\t\t\t\t<use [attr.xlink:href]=\"draw.url | prefix:urlPrefix\" x=\"6\" y=\"6\" width=\"63\" height=\"88\"/>\n\t\t\t\t<use xlink:href=\"#front\" x=\"0\" y=\"0\" width=\"75\" height=\"100\"/>\n\t\t\t</g>\n\t\t</g>\n\t</g>\n</svg>\n","import {Component, EventEmitter, Input, OnChanges, Output, SimpleChanges} from '@angular/core';\nimport {TranslateService} from '@ngx-translate/core';\nimport {Builder} from '../../model/builder';\nimport {Layout, Layouts} from '../../model/types';\nimport {LayoutService} from '../../service/layout.service';\nimport {LocalstorageService} from '../../service/localstorage.service';\n\nexport interface LayoutItem {\n\tlayout: Layout;\n\tvisible: boolean;\n\tplayCount?: number;\n\tbestTime?: number;\n\tselected?: boolean;\n}\n\nexport interface LayoutGroup {\n\tname: string;\n\tlayouts: Array<LayoutItem>;\n\tvisible: boolean;\n}\n\n@Component({\n\tselector: 'app-choose-layout',\n\ttemplateUrl: './choose-layout.component.html',\n\tstyleUrls: ['./choose-layout.component.scss']\n})\nexport class ChooseLayoutComponent implements OnChanges {\n\t@Input() layouts: Layouts;\n\t@Output() readonly startEvent = new EventEmitter<{ layout: Layout; mode: string }>();\n\tgroups: Array<LayoutGroup> = [];\n\tmode: string = 'MODE_SOLVABLE';\n\tbuilder: Builder = new Builder();\n\n\tconstructor(private layoutService: LayoutService, private storage: LocalstorageService, private translate: TranslateService) {\n\t}\n\n\tngOnChanges(changes: SimpleChanges): void {\n\t\tif (this.layouts) {\n\t\t\tthis.buildGroups();\n\t\t}\n\t\tsetTimeout(() => {\n\t\t\tthis.selectLastPlayed();\n\t\t});\n\t}\n\n\tonStart(layout: Layout): void {\n\t\tif (layout) {\n\t\t\tthis.startEvent.emit({layout, mode: this.mode});\n\t\t\tthis.storage.storeLastPlayed(layout.id);\n\t\t}\n\t}\n\n\tselectLastPlayed(): void {\n\t\tconst id = this.storage.getLastPlayed();\n\t\tif (id) {\n\t\t\tthis.groups.forEach(g => {\n\t\t\t\tg.layouts.forEach(layout => {\n\t\t\t\t\tlayout.selected = layout.layout.id === id;\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.scrollToItem(id);\n\t\t}\n\t}\n\n\tbuildGroups(): void {\n\t\tconst groups: Array<LayoutGroup> = [];\n\t\tconst g: { [name: string]: LayoutGroup } = {};\n\t\tfor (const layout of this.layouts.items) {\n\t\t\tif (!g[layout.category]) {\n\t\t\t\tg[layout.category] = {name: layout.category, layouts: [], visible: false};\n\t\t\t\tgroups.push(g[layout.category]);\n\t\t\t}\n\t\t\tconst score = this.storage.getScore(layout.id) || {};\n\t\t\tg[layout.category].layouts.push({layout, playCount: score.playCount, bestTime: score.bestTime, visible: false});\n\t\t}\n\t\tthis.groups = groups;\n\t}\n\n\trandomGame(): void {\n\t\tconst index = Math.floor(Math.random() * this.layouts.items.length);\n\t\tthis.onStart(this.layouts.items[index]);\n\t}\n\n\tonDrop(files: Array<File>): void {\n\t\tthis.layoutService.importFile(files[0])\n\t\t\t.then(layout => {\n\t\t\t\tthis.layouts.items.push(layout);\n\t\t\t\tthis.buildGroups();\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\talert(e);\n\t\t\t});\n\t}\n\n\tscrollToGroup(index: number): void {\n\t\tconst elements = document.getElementById(`group-${index}`);\n\t\tif (elements) {\n\t\t\telements.scrollIntoView();\n\t\t}\n\t}\n\n\tscrollToItem(id: string): void {\n\t\tconst elements = document.getElementById(`item-${id}`);\n\t\tif (elements) {\n\t\t\telements.scrollIntoView();\n\t\t}\n\t}\n\n\tclearBestTimeClick(event: MouseEvent, layout: LayoutItem): void {\n\t\tevent.stopPropagation();\n\t\tif (confirm(this.translate.instant('BEST_TIME_CLEAR_SURE'))) {\n\t\t\tthis.storage.clearScore(layout.layout.id);\n\t\t\tlayout.bestTime = undefined;\n\t\t\tlayout.playCount = undefined;\n\t\t}\n\t}\n}\n","<div class=\"headline\">\n\t<div>{{'SELECT_BOARD' | translate}}</div>\n</div>\n<div class=\"headline-anchors\" *ngIf=\"groups.length>1\">\n\t<a *ngFor=\"let group of groups; let i=index\" (click)=\"scrollToGroup(i)\">{{group.name}}</a>\n</div>\n<div class=\"groups\" appDeferLoadScrollHost (appDropZone)=\"onDrop($event)\">\n\t<div class=\"group\" *ngFor=\"let group of groups; let i=index\" id=\"group-{{i}}\" (appDeferLoad)=\"group.visible=true\">\n\t\t<div class=\"group-name\" *ngIf=\"groups.length>1\">{{group.name}} ({{group.layouts.length}})</div>\n\t\t<div class=\"previews\">\n\t\t\t<ng-container *ngIf=\"group.visible\">\n\t\t\t\t<div class=\"preview\"\n\t\t\t\t\t\t *ngFor=\"let item of group.layouts\"\n\t\t\t\t\t\t [id]=\"'item-'+item.layout.id\"\n\t\t\t\t\t\t [class.selected]=\"item.selected\"\n\t\t\t\t\t\t (click)=\"onStart(item.layout)\"\n\t\t\t\t\t\t (appDeferLoad)=\"item.visible=true\"\n\t\t\t\t>\n\t\t\t\t\t<app-layout-preview *ngIf=\"item.visible\" class=\"svg-board\" [layout]=\"item.layout\"></app-layout-preview>\n\t\t\t\t\t<div class=\"preview-best-time\" *ngIf=\"item.bestTime\">{{'STATS_BEST' | translate}}: {{item.bestTime|duration}}\n\t\t\t\t\t\t<a (click)=\"clearBestTimeClick($event, item)\">\n\t\t\t\t\t\t\t<i class=\"icon-trash-empty\"></i>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"preview-name\">{{item.layout.name}}</div>\n\t\t\t\t</div>\n\t\t\t</ng-container>\n\t\t\t<ng-container *ngIf=\"!group.visible\">\n\t\t\t\t<div class=\"preview\"\n\t\t\t\t\t\t *ngFor=\"let item of group.layouts\"\n\t\t\t\t\t\t [id]=\"'item-'+item.layout.id\"\n\t\t\t\t\t\t [class.selected]=\"item.selected\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"preview-name\">{{item.layout.name}}</div>\n\t\t\t\t</div>\n\t\t\t</ng-container>\n\t\t</div>\n\t</div>\n</div>\n<div class=\"choose-buttons\">\n\t<div class=\"generator\">\n\t\t<label for=\"board-generator-select\">{{'BOARD_GENERATOR' | translate}}:</label>\n\t\t<select id=\"board-generator-select\" [(ngModel)]=\"mode\">\n\t\t\t<option *ngFor=\"let m of builder.modes\" value=\"{{m.id}}\">{{m.id | translate}} - {{m.id + '_DESC' | translate}}</option>\n\t\t</select>\n\t</div>\n\t<div class=\"start-links\">\n\t\t<button class=\"link\" (click)=\"randomGame()\">{{'START_RANDOM' | translate}}</button>\n\t\t<!--\t\t<button class=\"link\" [disabled]=\"!current\" (click)=\"onStart(current)\">{{'START_SELECTED' | translate}}</button>-->\n\t</div>\n</div>\n\n","import {ImageSetDefault} from './consts';\nimport {SettingsStore, StorageProvider} from './types';\n\nexport class Settings {\n\tlang = 'auto';\n\tsounds = true;\n\t// music = false;\n\ttileset = ImageSetDefault;\n\tbackground = '';\n\tstats = {\n\t\tgames: 0,\n\t\tbestTime: 0\n\t};\n\n\tconstructor(private storageProvider: StorageProvider) {\n\t}\n\n\tload(): boolean {\n\t\ttry {\n\t\t\tconst store: SettingsStore | undefined = this.storageProvider.getSettings();\n\t\t\tif (store) {\n\t\t\t\tthis.lang = store.lang || 'auto';\n\t\t\t\tthis.tileset = store.tileset || ImageSetDefault;\n\t\t\t\tthis.background = store.background;\n\t\t\t\t// this.music = store.music || false;\n\t\t\t\tthis.sounds = store.sounds || false;\n\t\t\t\t// this.stats.games = store.games || 0;\n\t\t\t\t// this.stats.bestTime = store.bestTime || 0;\n\t\t\t}\n\t\t\treturn true;\n\t\t} catch (e) {\n\t\t\tconsole.error('load settings failed', e);\n\t\t}\n\t\treturn false;\n\t}\n\n\tsave(): boolean {\n\t\ttry {\n\t\t\tthis.storageProvider.storeSettings({\n\t\t\t\tlang: this.lang,\n\t\t\t\tsounds: this.sounds,\n\t\t\t\t// music: this.music,\n\t\t\t\tbackground: this.background,\n\t\t\t\ttileset: this.tileset\n\t\t\t\t// games: this.stats.games,\n\t\t\t\t// bestTime: this.stats.bestTime\n\t\t\t});\n\t\t\treturn true;\n\t\t} catch (e) {\n\t\t\tconsole.error('storing settings failed', e);\n\t\t}\n\t\treturn false;\n\t}\n}\n","/* eslint-disable max-classes-per-file */\nimport {safeGetStone, Stone} from './stone';\nimport {Tile, Tiles} from './tiles';\nimport {Mapping, Place} from './types';\n\ninterface BuilderType {\n\tbuild(mapping: Mapping, tiles: Tiles): Array<Stone>;\n}\n\nfunction random<T>(array: Array<T>): number {\n\treturn Math.floor(Math.random() * array.length);\n}\n\nfunction randomExtract<T>(array: Array<T>): T {\n\tconst i = random(array);\n\treturn array.splice(i, 1)[0];\n}\n\nfunction collectNodes(stones: Array<Stone>, stone: Stone): {\n\ttop: Array<Stone>;\n\tleft: Array<Stone>;\n\tright: Array<Stone>;\n\tbottom: Array<Stone>;\n} {\n\tconst nodes: {\n\t\ttop: Array<Stone>;\n\t\tleft: Array<Stone>;\n\t\tright: Array<Stone>;\n\t\tbottom: Array<Stone>;\n\t} = {left: [], right: [], top: [], bottom: []};\n\tlet s: Stone | undefined;\n\tfor (let y = stone.y - 1; y <= stone.y + 1; y++) {\n\t\ts = safeGetStone(stones, stone.z, stone.x - 2, y);\n\t\tif (s) {\n\t\t\tnodes.left.push(s);\n\t\t}\n\t\ts = safeGetStone(stones, stone.z, stone.x + 2, y);\n\t\tif (s) {\n\t\t\tnodes.right.push(s);\n\t\t}\n\t\tfor (let x = stone.x - 1; x <= stone.x + 1; x++) {\n\t\t\ts = safeGetStone(stones, stone.z + 1, x, y);\n\t\t\tif (s) {\n\t\t\t\tnodes.top.push(s);\n\t\t\t}\n\t\t\ts = safeGetStone(stones, stone.z - 1, x, y);\n\t\t\tif (s) {\n\t\t\t\tnodes.bottom.push(s);\n\t\t\t}\n\t\t}\n\t}\n\treturn nodes;\n}\n\nfunction fillStones(stones: Array<Stone>, tiles: Tiles): Array<Stone> {\n\tconst groups: { [index: number]: Array<Stone> } = {};\n\tstones.forEach((stone: Stone) => {\n\t\tconst tile = tiles.list[stone.v];\n\t\tstone.img = tile ? tile.img : {id: undefined};\n\t\tgroups[stone.groupnr] = groups[stone.groupnr] || [];\n\t\tgroups[stone.groupnr].push(stone);\n\t\tstone.nodes = collectNodes(stones, stone);\n\t});\n\tObject.keys(groups).forEach(key => {\n\t\tconst group: Array<Stone> = groups[parseInt(key, 10)];\n\t\tgroup.forEach((stone: Stone) => {\n\t\t\tstone.group = group.filter((s: Stone) =>\n\t\t\t\ts !== stone);\n\t\t});\n\t});\n\treturn stones;\n}\n\nclass LinearBoardBuilder implements BuilderType {\n\n\tbuild(mapping: Mapping, tiles: Tiles): Array<Stone> {\n\t\tconst remainingTiles: Array<Tile> = tiles.list.filter((tile: Tile): boolean => tile !== undefined);\n\t\tconst stones: Array<Stone> = [];\n\t\tmapping.forEach((place: Place) => {\n\t\t\tconst tile = randomExtract(remainingTiles);\n\t\t\tconst stone = new Stone(place[0], place[1], place[2], tile.v, tile.groupnr);\n\t\t\tstones.push(stone);\n\t\t});\n\t\tfillStones(stones, tiles);\n\t\treturn stones;\n\t}\n\n}\n\nclass RandomBoardBuilder implements BuilderType {\n\n\tbuild(mapping: Mapping, tiles: Tiles): Array<Stone> {\n\t\tconst remainingTiles = tiles.list.filter((tile: Tile) => tile !== undefined);\n\t\tconst stones: Array<Stone> = [];\n\t\tconst remainingPlaces = mapping.slice(0);\n\t\twhile (remainingTiles.length > 0) {\n\t\t\tconst tile = randomExtract(remainingTiles);\n\t\t\tconst place = randomExtract(remainingPlaces);\n\t\t\tstones.push(new Stone(place[0], place[1], place[2], tile.v, tile.groupnr));\n\t\t}\n\t\tfillStones(stones, tiles);\n\t\treturn stones;\n\t}\n}\n\nclass SolvableBoardBuilder implements BuilderType {\n\n\tbuild(mapping: Mapping, tiles: Tiles): Array<Stone> {\n\t\tconst stones: Array<Stone> = [];\n\t\tmapping.forEach((st: Place) => {\n\t\t\tstones.push(new Stone(st[0], st[1], st[2], 0, 0));\n\t\t});\n\t\tfillStones(stones, tiles); // grouping will be repaired later\n\t\tlet pairs = this.solve(stones, tiles);\n\t\tlet runs = 1;\n\t\twhile (pairs.length === 0 && runs < 100) {\n\t\t\tstones.forEach((stone: Stone) => {\n\t\t\t\tstone.picked = false;\n\t\t\t\tstone.v = 0;\n\t\t\t\tstone.groupnr = 0;\n\t\t\t});\n\t\t\tpairs = this.solve(stones, tiles);\n\t\t\truns++;\n\t\t}\n\t\tstones.forEach((stone: Stone) => {\n\t\t\tstone.picked = false;\n\t\t});\n\t\tfillStones(stones, tiles); // repair grouping & images, etc\n\t\tstones.sort((a: Stone, b: Stone) =>\n\t\t\ta.v - b.v);\n\t\treturn stones;\n\t}\n\n\tsolve(stones: Array<Stone>, tiles: Tiles): Array<Array<Tile>> {\n\t\tconst pairs: Array<Array<Tile>> = [];\n\t\tconst allpairs: Array<Array<Tile>> = [];\n\t\ttiles.groups.forEach(group => {\n\t\t\tconst g: Array<Tile> = group.tiles.slice();\n\t\t\tconst tile1 = randomExtract(g);\n\t\t\tconst tile2 = randomExtract(g);\n\t\t\tconst tile3 = randomExtract(g);\n\t\t\tconst tile4 = g[0];\n\t\t\tallpairs.push([tile1, tile2]);\n\t\t\tallpairs.push([tile3, tile4]);\n\t\t});\n\t\twhile (allpairs.length > 0) {\n\t\t\tconst pair: Array<Tile> = randomExtract(allpairs);\n\t\t\tconst freestones: Array<Stone> = stones.filter((stone: Stone) =>\n\t\t\t\t!stone.picked && !stone.isBlocked());\n\t\t\tif (freestones.length < 2) {\n\t\t\t\t// not enough free places\n\t\t\t\t// this may happen if the last stones are directly on each other\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tconst place1 = randomExtract(freestones);\n\t\t\tconst place2 = randomExtract(freestones);\n\t\t\tplace1.v = pair[0].v;\n\t\t\tplace1.img = pair[0].img;\n\t\t\tplace1.groupnr = pair[0].groupnr;\n\t\t\tplace1.picked = true;\n\t\t\tplace2.v = pair[1].v;\n\t\t\tplace2.img = pair[1].img;\n\t\t\tplace2.groupnr = pair[1].groupnr;\n\t\t\tplace2.picked = true;\n\t\t\tpairs.push(pair);\n\t\t}\n\t\treturn pairs;\n\t}\n\n}\n\nclass LoadBoardBuilder implements BuilderType {\n\n\tbuild(mapping: Mapping, tiles: Tiles): Array<Stone> {\n\t\tconst stones: Array<Stone> = [];\n\t\tmapping.forEach((st: Array<number>) => {\n\t\t\tconst tile: Tile = tiles.list[st[3]];\n\t\t\tif (tile) {\n\t\t\t\tconst stone = new Stone(st[0], st[1], st[2], st[3], tile.groupnr);\n\t\t\t\tstones.push(stone);\n\t\t\t}\n\t\t});\n\t\tfillStones(stones, tiles);\n\t\treturn stones;\n\t}\n\n}\n\nexport const BuilderModes = [\n\t{id: 'MODE_SOLVABLE', builder: SolvableBoardBuilder},\n\t{id: 'MODE_LINEAR', builder: LinearBoardBuilder},\n\t{id: 'MODE_RANDOM', builder: RandomBoardBuilder}\n];\n\nexport class Builder {\n\ttiles = new Tiles();\n\tmodes = BuilderModes;\n\n\tbuild(mode: string, mapping: Mapping): Array<Stone> | undefined {\n\t\tlet builder: BuilderType | undefined;\n\t\tif (mode === 'load') {\n\t\t\tbuilder = new LoadBoardBuilder();\n\t\t} else {\n\t\t\tconst buildermode = BuilderModes.find(m => m.id === mode);\n\t\t\tif (buildermode) {\n\t\t\t\tbuilder = new buildermode.builder();\n\t\t\t}\n\t\t}\n\t\tif (builder) {\n\t\t\treturn builder.build(mapping, this.tiles);\n\t\t}\n\t\treturn;\n\t}\n}\n","import {enableProdMode} from '@angular/core';\nimport {platformBrowserDynamic} from '@angular/platform-browser-dynamic';\nimport {AppModule} from './app/app.module';\nimport {environment} from './environments/environment';\n\nif (environment.production) {\n\tenableProdMode();\n}\n\nplatformBrowserDynamic()\n\t.bootstrapModule(AppModule)\n\t.catch(err => {\n\t\tconsole.error(err);\n\t});\n","import {Directive, ElementRef, HostListener, Input, OnChanges, SimpleChange} from '@angular/core';\nimport {DeferLoadService} from './defer-load.service';\n\n@Directive({\n\tselector: '[appDeferLoadScrollHost]'\n})\nexport class DeferLoadScrollHostDirective implements OnChanges {\n\t@Input() scrollTo: any;\n\n\tconstructor(private element: ElementRef, private scrollNotify: DeferLoadService) {\n\t}\n\n\tngOnChanges(changes: { [propName: string]: SimpleChange }): void {\n\t\tif (changes.scrollTo && changes.scrollTo.currentValue) {\n\t\t\tconst o = changes.scrollTo.currentValue;\n\t\t\tif (o.id && o.id.length > 0) {\n\t\t\t\tconst elm = document.getElementById(o.id);\n\t\t\t\tif (elm) {\n\t\t\t\t\tthis.element.nativeElement.scrollTop = elm.offsetTop - elm.offsetHeight;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t@HostListener('scroll', ['$event'])\n\tscrollTrack(event: Event): void {\n\t\tthis.scrollNotify.notifyScroll({name: 'scroll-host', element: this.element.nativeElement});\n\t}\n}\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"]}